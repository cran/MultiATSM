<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Rubens Moura" />

<meta name="date" content="2025-10-22" />

<title>Paper Replications</title>

<script>$(document).ready(function(){
    if (typeof $('[data-toggle="tooltip"]').tooltip === 'function') {
        $('[data-toggle="tooltip"]').tooltip();
    }
    if ($('[data-toggle="popover"]').popover === 'function') {
        $('[data-toggle="popover"]').popover();
    }
});
</script>
<style type="text/css">
.lightable-minimal {
border-collapse: separate;
border-spacing: 16px 1px;
width: 100%;
margin-bottom: 10px;
}
.lightable-minimal td {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal th {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal thead tr:last-child th {
border-bottom: 2px solid #00000050;
empty-cells: hide;
}
.lightable-minimal tbody tr:first-child td {
padding-top: 0.5em;
}
.lightable-minimal.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-minimal.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic {
border-top: 0.16em solid #111111;
border-bottom: 0.16em solid #111111;
width: 100%;
margin-bottom: 10px;
margin: 10px 5px;
}
.lightable-classic tfoot tr td {
border: 0;
}
.lightable-classic tfoot tr:first-child td {
border-top: 0.14em solid #111111;
}
.lightable-classic caption {
color: #222222;
}
.lightable-classic td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic thead tr:last-child th {
border-bottom: 0.10em solid #111111;
}
.lightable-classic.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic-2 {
border-top: 3px double #111111;
border-bottom: 3px double #111111;
width: 100%;
margin-bottom: 10px;
}
.lightable-classic-2 tfoot tr td {
border: 0;
}
.lightable-classic-2 tfoot tr:first-child td {
border-top: 3px double #111111;
}
.lightable-classic-2 caption {
color: #222222;
}
.lightable-classic-2 td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic-2 th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic-2 tbody tr:last-child td {
border-bottom: 3px double #111111;
}
.lightable-classic-2 thead tr:last-child th {
border-bottom: 1px solid #111111;
}
.lightable-classic-2.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic-2.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #EEE;
border-collapse: collapse;
margin-bottom: 10px;
}
.lightable-material tfoot tr td {
border: 0;
}
.lightable-material tfoot tr:first-child td {
border-top: 1px solid #EEE;
}
.lightable-material th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
}
.lightable-material td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
border-top: 1px solid #eeeeee;
}
.lightable-material.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody td {
border: 0;
}
.lightable-material.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #ddd;
}
.lightable-material-dark {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #FFFFFF12;
border-collapse: collapse;
margin-bottom: 10px;
background-color: #363640;
}
.lightable-material-dark tfoot tr td {
border: 0;
}
.lightable-material-dark tfoot tr:first-child td {
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF60;
}
.lightable-material-dark td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF;
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark.lightable-hover tbody tr:hover {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody tr:nth-child(even) {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody td {
border: 0;
}
.lightable-material-dark.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #FFFFFF12;
}
.lightable-paper {
width: 100%;
margin-bottom: 10px;
color: #444;
}
.lightable-paper tfoot tr td {
border: 0;
}
.lightable-paper tfoot tr:first-child td {
border-top: 1px solid #00000020;
}
.lightable-paper thead tr:last-child th {
color: #666;
vertical-align: bottom;
border-bottom: 1px solid #00000020;
line-height: 1.15em;
padding: 10px 5px;
}
.lightable-paper td {
vertical-align: middle;
border-bottom: 1px solid #00000010;
line-height: 1.15em;
padding: 7px 5px;
}
.lightable-paper.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-paper.lightable-striped tbody tr:nth-child(even) {
background-color: #00000008;
}
.lightable-paper.lightable-striped tbody td {
border: 0;
}
</style>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">

div.csl-bib-body { }
div.csl-entry {
clear: both;
}
.hanging div.csl-entry {
margin-left:2em;
text-indent:-2em;
}
div.csl-left-margin {
min-width:2em;
float:left;
}
div.csl-right-inline {
margin-left:2em;
padding-left:1em;
}
div.csl-indent {
margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Paper Replications</h1>
<h4 class="author">Rubens Moura</h4>
<h4 class="date">2025-10-22</h4>


<div id="TOC">
<ul>
<li><a href="#joslin-priebisch-and-singleton-2014" id="toc-joslin-priebisch-and-singleton-2014"><span class="toc-section-number">1</span> Joslin, Priebisch and Singleton (2014)</a></li>
<li><a href="#candelon-and-moura-2024" id="toc-candelon-and-moura-2024"><span class="toc-section-number">2</span> Candelon and Moura (2024)</a></li>
<li><a href="#candelon-and-moura-2023" id="toc-candelon-and-moura-2023"><span class="toc-section-number">3</span> Candelon and Moura (2023)</a></li>
<li><a href="#references" id="toc-references">References</a></li>
</ul>
</div>

<p>This vignette leverages the <em>MultiATSM</em> package to reproduce some empirical findings from three academic papers centered around the unspanned macroeconomic risk framework. The first segment focuses on replicating the outcomes of <span class="citation">Joslin, Priebsch, and Singleton (2014)</span>, which laid the foundation for the unspanned risk ATSM literature through a single-country analysis of the U.S. economy. Subsequently, I present the multi-country model extension proposed by <span class="citation">Candelon and Moura (2024)</span>, employing a GVAR approach to capture risk factor dynamics. Lastly, I introduce the program designed to replicate results detailed in <span class="citation">Candelon and Moura (2023)</span>, an extension of the previous framework to investigate the term structure behavior of major emerging markets during the unprecedented COVID<span class="math inline">\(-19\)</span> pandemic. It is worth highlighting that, due to limited public availability of bond yield data, I employ, in certain instances, simulated data closely matching the original papers’ construction method. Consequently, while the outputs generated by the scripts below may not exactly mirror those from the original papers, the main features of these results are preserved.</p>
<p>A thorough explanation on the usage of the additional functionalities of the <em>MultiATSM</em> package are documented in the vignette <strong>General Guidelines</strong>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(MultiATSM)</span></code></pre></div>
<div id="joslin-priebisch-and-singleton-2014" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Joslin, Priebisch and Singleton (2014)</h1>
<p>The database used in this replication was constructed by <span class="citation">Bauer and Rudebusch (2017)</span> (BR, 2017) and is available at <a href="https://www.michaeldbauer.com/publication/spanning-puzzle/">Bauer’s website</a>. In that paper, BR (2017) investigate whether macro-finance term structure models better suit the unspanned macro risk framework by JPS (2014) or the earlier traditional spanned settings as the one by <span class="citation">Ang and Piazzesi (2003)</span>. Accordingly, BR (2017) intend to replicate some of the empirical results reported in JPS (2014). The R-code used by BR (2017) is also available at <a href="https://www.michaeldbauer.com/publication/spanning-puzzle/">Bauer’s website</a>.</p>
<p>Supported by BR (2017)’s data-set, the code below uses the <em>MultiATSM</em> package to estimate the key model parameters from the ATSM along the lines of JPS (2014). The model estimation is performed using the <em>JPS original</em> modeling setup.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># A) Load database data</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">LoadData</span>(<span class="st">&quot;BR_2017&quot;</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="co"># B) GENERAL model inputs</span></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>ModelType <span class="ot">&lt;-</span> <span class="st">&quot;JPS original&quot;</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>Economies <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;US&quot;</span>) <span class="co"># Names of the economies from the economic system</span></span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>GlobalVar <span class="ot">&lt;-</span> <span class="fu">c</span>() <span class="co"># Global Variables</span></span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>DomVar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;GRO&quot;</span>, <span class="st">&quot;INF&quot;</span>) <span class="co"># Country-specific variables</span></span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># Number of spanned factors per country</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>t0_sample <span class="ot">&lt;-</span> <span class="st">&quot;January-1985&quot;</span></span>
<span id="cb2-13"><a href="#cb2-13" tabindex="-1"></a>tF_sample <span class="ot">&lt;-</span> <span class="st">&quot;December-2007&quot;</span></span>
<span id="cb2-14"><a href="#cb2-14" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" tabindex="-1"></a>DataFreq <span class="ot">&lt;-</span> <span class="st">&quot;Monthly&quot;</span> <span class="co"># Frequency of the data</span></span>
<span id="cb2-16"><a href="#cb2-16" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" tabindex="-1"></a>StatQ <span class="ot">&lt;-</span> <span class="cn">FALSE</span> <span class="co"># Stationary condition</span></span>
<span id="cb2-18"><a href="#cb2-18" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" tabindex="-1"></a><span class="do">#########################################################################################################</span></span>
<span id="cb2-20"><a href="#cb2-20" tabindex="-1"></a><span class="do">############################### NO NEED TO MAKE CHANGES FROM HERE #######################################</span></span>
<span id="cb2-21"><a href="#cb2-21" tabindex="-1"></a><span class="do">#########################################################################################################</span></span>
<span id="cb2-22"><a href="#cb2-22" tabindex="-1"></a><span class="co"># 2) Minor preliminary work</span></span>
<span id="cb2-23"><a href="#cb2-23" tabindex="-1"></a>FactorLabels <span class="ot">&lt;-</span> <span class="fu">LabFac</span>(N, DomVar, GlobalVar, Economies, ModelType)</span>
<span id="cb2-24"><a href="#cb2-24" tabindex="-1"></a></span>
<span id="cb2-25"><a href="#cb2-25" tabindex="-1"></a>Yields <span class="ot">&lt;-</span> <span class="fu">t</span>(BR_jps_out<span class="sc">$</span>Y)</span>
<span id="cb2-26"><a href="#cb2-26" tabindex="-1"></a>DomesticMacroVar <span class="ot">&lt;-</span> <span class="fu">t</span>(BR_jps_out<span class="sc">$</span>M.o)</span>
<span id="cb2-27"><a href="#cb2-27" tabindex="-1"></a>GlobalMacroVar <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb2-28"><a href="#cb2-28" tabindex="-1"></a></span>
<span id="cb2-29"><a href="#cb2-29" tabindex="-1"></a><span class="co"># 3) Prepare the inputs of the likelihood function</span></span>
<span id="cb2-30"><a href="#cb2-30" tabindex="-1"></a>ATSMInputs <span class="ot">&lt;-</span> <span class="fu">InputsForOpt</span>(t0_sample, tF_sample, ModelType, Yields, GlobalMacroVar, DomesticMacroVar,</span>
<span id="cb2-31"><a href="#cb2-31" tabindex="-1"></a>  FactorLabels, Economies, DataFreq,</span>
<span id="cb2-32"><a href="#cb2-32" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb2-33"><a href="#cb2-33" tabindex="-1"></a>)</span>
<span id="cb2-34"><a href="#cb2-34" tabindex="-1"></a></span>
<span id="cb2-35"><a href="#cb2-35" tabindex="-1"></a><span class="co"># 4) Optimization of the model</span></span>
<span id="cb2-36"><a href="#cb2-36" tabindex="-1"></a>ModelPara <span class="ot">&lt;-</span> <span class="fu">Optimization</span>(ATSMInputs, StatQ, DataFreq, FactorLabels, Economies, ModelType,</span>
<span id="cb2-37"><a href="#cb2-37" tabindex="-1"></a>  <span class="at">verbose =</span> <span class="cn">FALSE</span></span>
<span id="cb2-38"><a href="#cb2-38" tabindex="-1"></a>)</span></code></pre></div>
<p>The tables below compare the ATSM parameter estimates generated from BR (2017) and the <em>MultiATSM</em>. Overall, one can note that the differences in the estimates are economically modest.</p>
<table class=" lightable-classic lightable-striped" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;">
<caption>
<span id="tab:unnamed-chunk-3">Table 1.1: </span><span class="math inline">\(Q\)</span>-dynamics parameters
</caption>
<thead>
<tr>
<th style="text-align:left;font-size: 14px;">
</th>
<th style="text-align:center;font-size: 14px;">
MultiATSM
</th>
<th style="text-align:center;font-size: 14px;">
BR (2017)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(r0\)</span>
</td>
<td style="text-align:center;">
0.00055
</td>
<td style="text-align:center;">
-0.00016
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\lambda_1\)</span>
</td>
<td style="text-align:center;">
0.99670
</td>
<td style="text-align:center;">
0.99682
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\lambda_2\)</span>
</td>
<td style="text-align:center;">
0.91488
</td>
<td style="text-align:center;">
0.95945
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\lambda_3\)</span>
</td>
<td style="text-align:center;">
0.91488
</td>
<td style="text-align:center;">
0.87174
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> <span class="math inline">\(\lambda\)</span>’s are the eigenvalues from the risk-neutral feedback matrix and <span class="math inline">\(r0\)</span> is the long-run mean of the short rate under Q.
</td>
</tr>
</tfoot>
</table>
<p><a id="tab-PdynTab"></a></p>
<table class=" lightable-classic lightable-striped" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;">
<caption>
<span id="tab:PdynTab">Table 1.2: </span><span class="math inline">\(P\)</span>-dynamics parameters
</caption>
<thead>
<tr>
<th style="empty-cells: hide;" colspan="1">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; font-weight: bold; " colspan="1">
<div style="TRUE">
K0Z
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; font-weight: bold; " colspan="5">
<div style="TRUE">
K1Z
</div>
</th>
</tr>
<tr>
<th style="text-align:left;font-size: 14px;">
</th>
<th style="text-align:center;font-size: 14px;">
</th>
<th style="text-align:center;font-size: 14px;">
PC1
</th>
<th style="text-align:center;font-size: 14px;">
PC2
</th>
<th style="text-align:center;font-size: 14px;">
PC3
</th>
<th style="text-align:center;font-size: 14px;">
GRO
</th>
<th style="text-align:center;font-size: 14px;">
INF
</th>
</tr>
</thead>
<tbody>
<tr grouplength="5">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>BR (2017)</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
PC1
</td>
<td style="text-align:center;">
0.07811
</td>
<td style="text-align:center;">
0.93691
</td>
<td style="text-align:center;">
-0.01307
</td>
<td style="text-align:center;">
-0.02181
</td>
<td style="text-align:center;">
0.10457
</td>
<td style="text-align:center;">
0.10033
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
PC2
</td>
<td style="text-align:center;">
0.02100
</td>
<td style="text-align:center;">
0.00582
</td>
<td style="text-align:center;">
0.97814
</td>
<td style="text-align:center;">
0.17031
</td>
<td style="text-align:center;">
-0.16719
</td>
<td style="text-align:center;">
-0.04016
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
PC3
</td>
<td style="text-align:center;">
0.10047
</td>
<td style="text-align:center;">
-0.01037
</td>
<td style="text-align:center;">
-0.00625
</td>
<td style="text-align:center;">
0.78346
</td>
<td style="text-align:center;">
-0.03987
</td>
<td style="text-align:center;">
0.04369
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
GRO
</td>
<td style="text-align:center;">
0.06904
</td>
<td style="text-align:center;">
-0.00483
</td>
<td style="text-align:center;">
0.01801
</td>
<td style="text-align:center;">
-0.11117
</td>
<td style="text-align:center;">
0.88177
</td>
<td style="text-align:center;">
-0.00247
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
INF
</td>
<td style="text-align:center;">
0.04996
</td>
<td style="text-align:center;">
0.00185
</td>
<td style="text-align:center;">
0.00642
</td>
<td style="text-align:center;">
-0.05920
</td>
<td style="text-align:center;">
0.02767
</td>
<td style="text-align:center;">
0.98593
</td>
</tr>
<tr grouplength="5">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>MultiATSM</strong>
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
PC1
</td>
<td style="text-align:center;">
0.07811
</td>
<td style="text-align:center;">
0.93691
</td>
<td style="text-align:center;">
-0.01307
</td>
<td style="text-align:center;">
-0.02181
</td>
<td style="text-align:center;">
0.10457
</td>
<td style="text-align:center;">
0.10033
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
PC2
</td>
<td style="text-align:center;">
0.02100
</td>
<td style="text-align:center;">
0.00582
</td>
<td style="text-align:center;">
0.97814
</td>
<td style="text-align:center;">
0.17031
</td>
<td style="text-align:center;">
-0.16719
</td>
<td style="text-align:center;">
-0.04016
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
PC3
</td>
<td style="text-align:center;">
0.10047
</td>
<td style="text-align:center;">
-0.01037
</td>
<td style="text-align:center;">
-0.00625
</td>
<td style="text-align:center;">
0.78346
</td>
<td style="text-align:center;">
-0.03987
</td>
<td style="text-align:center;">
0.04369
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
GRO
</td>
<td style="text-align:center;">
0.06904
</td>
<td style="text-align:center;">
-0.00483
</td>
<td style="text-align:center;">
0.01801
</td>
<td style="text-align:center;">
-0.11117
</td>
<td style="text-align:center;">
0.88177
</td>
<td style="text-align:center;">
-0.00247
</td>
</tr>
<tr>
<td style="text-align:left;padding-left: 2em;" indentlevel="1">
INF
</td>
<td style="text-align:center;">
0.04996
</td>
<td style="text-align:center;">
0.00185
</td>
<td style="text-align:center;">
0.00642
</td>
<td style="text-align:center;">
-0.05920
</td>
<td style="text-align:center;">
0.02767
</td>
<td style="text-align:center;">
0.98593
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> <span class="math inline">\(K0Z\)</span> is the intercept and <span class="math inline">\(K1Z\)</span> is feedback matrix from the <span class="math inline">\(P\)</span>-dynamics.
</td>
</tr>
</tfoot>
</table>
<table class=" lightable-classic lightable-striped" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;border-bottom: 0;">
<caption>
<span id="tab:unnamed-chunk-4">Table 1.3: </span>Portfolio of yields with errors
</caption>
<thead>
<tr>
<th style="text-align:left;font-size: 14px;">
</th>
<th style="text-align:center;font-size: 14px;">
MultiATSM
</th>
<th style="text-align:center;font-size: 14px;">
BR (2017)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
se
</td>
<td style="text-align:center;">
0.0000546
</td>
<td style="text-align:center;">
0.000055
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; " colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; " colspan="100%">
<sup></sup> <span class="math inline">\(se\)</span> is the standard deviation of the portfolio of yields observed with errors.
</td>
</tr>
</tfoot>
</table>
<p>For replicability, it is important to note that the <span class="math inline">\(P-\)</span>dynamics results reported in <a href="#tab-PdynTab">Table 1.2</a> for the <em>MultiATSM</em> package make use of the principal component weights provided by BR (2017). Such a matrix is simply a scaled-up version of the one provided by the function <code>pca_weights_one_country()</code> of this package. Accordingly, despite the numerical differences on the weight matrices, both methods generate time series of spanned factors which are perfectly correlated. Another difference between the two approaches relates to the construction form of the log-likelihood function (llk): while in the BR (2017) code the llk is expressed in terms of a portfolio of yields, the <em>MultiATSM</em> package generates this same input directly as a function of observed yields (i.e. both procedures lead to equivalent llk up to the Jacobian term).</p>
</div>
<div id="candelon-and-moura-2024" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Candelon and Moura (2024)</h1>
<p>The multi-country framework introduced in <span class="citation">Candelon and Moura (2024)</span> was designed to enhance the tractability of large-scale ATSMs, providing a deeper understanding of the intricate global economic mechanisms that underlie yield curve fluctuations. This framework also reinforces the statistical validity of inference and enhances the predictive capabilities of these models. This novel setup, embodied by the <em>GVAR multi</em> model class, is benchmarked against the findings of <span class="citation">Jotikasthira, Le, and Lundblad (2015)</span>, which are captured by the <em>JLL original</em> model class. The paper showcases an empirical illustration involving China, Brazil, Mexico, and Uruguay.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># A) Load database data</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="fu">LoadData</span>(<span class="st">&quot;CM_2024&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co"># B) GENERAL model inputs</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>ModelType <span class="ot">&lt;-</span> <span class="st">&quot;GVAR multi&quot;</span> <span class="co"># Options: &quot;GVAR multi&quot; or &quot;JLL original&quot;.</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>Economies <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;China&quot;</span>, <span class="st">&quot;Brazil&quot;</span>, <span class="st">&quot;Mexico&quot;</span>, <span class="st">&quot;Uruguay&quot;</span>)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>GlobalVar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Gl_Eco_Act&quot;</span>, <span class="st">&quot;Gl_Inflation&quot;</span>)</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>DomVar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Eco_Act&quot;</span>, <span class="st">&quot;Inflation&quot;</span>)</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a></span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>t0_sample <span class="ot">&lt;-</span> <span class="st">&quot;01-06-2004&quot;</span></span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>tF_sample <span class="ot">&lt;-</span> <span class="st">&quot;01-01-2020&quot;</span></span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>OutputLabel <span class="ot">&lt;-</span> <span class="st">&quot;CM_jfec&quot;</span></span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a>DataFreq <span class="ot">&lt;-</span> <span class="st">&quot;Monthly&quot;</span></span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a>Folder2Save <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" tabindex="-1"></a>StatQ <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb3-20"><a href="#cb3-20" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" tabindex="-1"></a><span class="co"># B.1) SPECIFIC model inputs</span></span>
<span id="cb3-22"><a href="#cb3-22" tabindex="-1"></a><span class="do">#################################### GVAR-based models ##################################################</span></span>
<span id="cb3-23"><a href="#cb3-23" tabindex="-1"></a>GVARlist <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb3-24"><a href="#cb3-24" tabindex="-1"></a>  <span class="at">VARXtype =</span> <span class="st">&quot;unconstrained&quot;</span>, <span class="at">W_type =</span> <span class="st">&quot;Sample Mean&quot;</span>, <span class="at">t_First_Wgvar =</span> <span class="st">&quot;2004&quot;</span>,</span>
<span id="cb3-25"><a href="#cb3-25" tabindex="-1"></a>  <span class="at">t_Last_Wgvar =</span> <span class="st">&quot;2019&quot;</span>, <span class="at">DataConnectedness =</span> TradeFlows</span>
<span id="cb3-26"><a href="#cb3-26" tabindex="-1"></a>)</span>
<span id="cb3-27"><a href="#cb3-27" tabindex="-1"></a><span class="do">#################################### JLL-based models ###################################################</span></span>
<span id="cb3-28"><a href="#cb3-28" tabindex="-1"></a>JLLlist <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">DomUnit =</span> <span class="st">&quot;China&quot;</span>)</span>
<span id="cb3-29"><a href="#cb3-29" tabindex="-1"></a><span class="do">###################################### BRW inputs  ######################################################</span></span>
<span id="cb3-30"><a href="#cb3-30" tabindex="-1"></a>WishBC <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb3-31"><a href="#cb3-31" tabindex="-1"></a>BRWlist <span class="ot">&lt;-</span> <span class="fu">within</span>(<span class="fu">list</span>(</span>
<span id="cb3-32"><a href="#cb3-32" tabindex="-1"></a>  <span class="at">Cent_Measure =</span> <span class="st">&quot;Mean&quot;</span>, <span class="at">gamma =</span> <span class="fl">0.001</span>, <span class="at">N_iter =</span> <span class="dv">200</span>, <span class="at">B =</span> <span class="dv">50</span>, <span class="at">checkBRW =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-33"><a href="#cb3-33" tabindex="-1"></a>  <span class="at">B_check =</span> <span class="dv">1000</span>, <span class="at">Eigen_rest =</span> <span class="dv">1</span></span>
<span id="cb3-34"><a href="#cb3-34" tabindex="-1"></a>), N_burn <span class="ot">&lt;-</span> <span class="fu">round</span>(N_iter <span class="sc">*</span> <span class="fl">0.15</span>))</span>
<span id="cb3-35"><a href="#cb3-35" tabindex="-1"></a></span>
<span id="cb3-36"><a href="#cb3-36" tabindex="-1"></a><span class="co"># C) Decide on Settings for numerical outputs</span></span>
<span id="cb3-37"><a href="#cb3-37" tabindex="-1"></a>WishFPremia <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb3-38"><a href="#cb3-38" tabindex="-1"></a>FPmatLim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">24</span>, <span class="dv">36</span>)</span>
<span id="cb3-39"><a href="#cb3-39" tabindex="-1"></a></span>
<span id="cb3-40"><a href="#cb3-40" tabindex="-1"></a>Horiz <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb3-41"><a href="#cb3-41" tabindex="-1"></a>DesiredGraphs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;GIRF&quot;</span>, <span class="st">&quot;GFEVD&quot;</span>, <span class="st">&quot;TermPremia&quot;</span>)</span>
<span id="cb3-42"><a href="#cb3-42" tabindex="-1"></a>WishGraphRiskFac <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb3-43"><a href="#cb3-43" tabindex="-1"></a>WishGraphYields <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb3-44"><a href="#cb3-44" tabindex="-1"></a>WishOrthoJLLgraphs <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb3-45"><a href="#cb3-45" tabindex="-1"></a></span>
<span id="cb3-46"><a href="#cb3-46" tabindex="-1"></a><span class="co"># D) Bootstrap settings</span></span>
<span id="cb3-47"><a href="#cb3-47" tabindex="-1"></a>WishBootstrap <span class="ot">&lt;-</span> <span class="cn">FALSE</span> <span class="co">#  Set it to TRUE, if bootstrap is desired</span></span>
<span id="cb3-48"><a href="#cb3-48" tabindex="-1"></a>BootList <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">methodBS =</span> <span class="st">&quot;bs&quot;</span>, <span class="at">BlockLength =</span> <span class="dv">4</span>, <span class="at">ndraws =</span> <span class="dv">1000</span>, <span class="at">pctg =</span> <span class="dv">95</span>)</span>
<span id="cb3-49"><a href="#cb3-49" tabindex="-1"></a></span>
<span id="cb3-50"><a href="#cb3-50" tabindex="-1"></a><span class="co"># E) Out-of-sample forecast</span></span>
<span id="cb3-51"><a href="#cb3-51" tabindex="-1"></a>WishForecast <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb3-52"><a href="#cb3-52" tabindex="-1"></a>ForecastList <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">ForHoriz =</span> <span class="dv">12</span>, <span class="at">t0Sample =</span> <span class="dv">1</span>, <span class="at">t0Forecast =</span> <span class="dv">100</span>, <span class="at">ForType =</span> <span class="st">&quot;Rolling&quot;</span>)</span>
<span id="cb3-53"><a href="#cb3-53" tabindex="-1"></a></span>
<span id="cb3-54"><a href="#cb3-54" tabindex="-1"></a><span class="do">#########################################################################################################</span></span>
<span id="cb3-55"><a href="#cb3-55" tabindex="-1"></a><span class="do">############################### NO NEED TO MAKE CHANGES FROM HERE #######################################</span></span>
<span id="cb3-56"><a href="#cb3-56" tabindex="-1"></a><span class="do">#########################################################################################################</span></span>
<span id="cb3-57"><a href="#cb3-57" tabindex="-1"></a></span>
<span id="cb3-58"><a href="#cb3-58" tabindex="-1"></a><span class="co"># 2) Minor preliminary work: get the sets of factor labels and  a vector of common maturities</span></span>
<span id="cb3-59"><a href="#cb3-59" tabindex="-1"></a>FactorLabels <span class="ot">&lt;-</span> <span class="fu">LabFac</span>(N, DomVar, GlobalVar, Economies, ModelType)</span>
<span id="cb3-60"><a href="#cb3-60" tabindex="-1"></a></span>
<span id="cb3-61"><a href="#cb3-61" tabindex="-1"></a><span class="co"># 3) Prepare the inputs of the likelihood function</span></span>
<span id="cb3-62"><a href="#cb3-62" tabindex="-1"></a>ATSMInputs <span class="ot">&lt;-</span> <span class="fu">InputsForOpt</span>(</span>
<span id="cb3-63"><a href="#cb3-63" tabindex="-1"></a>  t0_sample, tF_sample, ModelType, Yields, GlobalMacro, DomMacro,</span>
<span id="cb3-64"><a href="#cb3-64" tabindex="-1"></a>  FactorLabels, Economies, DataFreq, GVARlist, JLLlist, WishBC, BRWlist</span>
<span id="cb3-65"><a href="#cb3-65" tabindex="-1"></a>)</span>
<span id="cb3-66"><a href="#cb3-66" tabindex="-1"></a></span>
<span id="cb3-67"><a href="#cb3-67" tabindex="-1"></a><span class="co"># 4) Optimization of the ATSM (Point Estimates)</span></span>
<span id="cb3-68"><a href="#cb3-68" tabindex="-1"></a>ModelParaList <span class="ot">&lt;-</span> <span class="fu">Optimization</span>(ATSMInputs, StatQ, DataFreq, FactorLabels, Economies, ModelType)</span>
<span id="cb3-69"><a href="#cb3-69" tabindex="-1"></a></span>
<span id="cb3-70"><a href="#cb3-70" tabindex="-1"></a><span class="co"># 5) Numerical and graphical outputs</span></span>
<span id="cb3-71"><a href="#cb3-71" tabindex="-1"></a><span class="co"># a) Prepare list of inputs for graphs and numerical outputs</span></span>
<span id="cb3-72"><a href="#cb3-72" tabindex="-1"></a>InputsForOutputs <span class="ot">&lt;-</span> <span class="fu">InputsForOutputs</span>(</span>
<span id="cb3-73"><a href="#cb3-73" tabindex="-1"></a>  ModelType, Horiz, DesiredGraphs, OutputLabel, StatQ, DataFreq,</span>
<span id="cb3-74"><a href="#cb3-74" tabindex="-1"></a>  WishGraphYields, WishGraphRiskFac, WishOrthoJLLgraphs, WishFPremia,</span>
<span id="cb3-75"><a href="#cb3-75" tabindex="-1"></a>  FPmatLim, WishBootstrap, BootList, WishForecast, ForecastList</span>
<span id="cb3-76"><a href="#cb3-76" tabindex="-1"></a>)</span>
<span id="cb3-77"><a href="#cb3-77" tabindex="-1"></a></span>
<span id="cb3-78"><a href="#cb3-78" tabindex="-1"></a><span class="co"># b) Fit, IRF, FEVD, GIRF, GFEVD, and Term Premia</span></span>
<span id="cb3-79"><a href="#cb3-79" tabindex="-1"></a>NumericalOutputs <span class="ot">&lt;-</span> <span class="fu">NumOutputs</span>(</span>
<span id="cb3-80"><a href="#cb3-80" tabindex="-1"></a>  ModelType, ModelParaList, InputsForOutputs, FactorLabels,</span>
<span id="cb3-81"><a href="#cb3-81" tabindex="-1"></a>  Economies, Folder2Save</span>
<span id="cb3-82"><a href="#cb3-82" tabindex="-1"></a>)</span>
<span id="cb3-83"><a href="#cb3-83" tabindex="-1"></a></span>
<span id="cb3-84"><a href="#cb3-84" tabindex="-1"></a><span class="co"># c) Confidence intervals (bootstrap analysis)</span></span>
<span id="cb3-85"><a href="#cb3-85" tabindex="-1"></a>BootstrapAnalysis <span class="ot">&lt;-</span> <span class="fu">Bootstrap</span>(</span>
<span id="cb3-86"><a href="#cb3-86" tabindex="-1"></a>  ModelType, ModelParaList, NumericalOutputs, Economies, InputsForOutputs,</span>
<span id="cb3-87"><a href="#cb3-87" tabindex="-1"></a>  FactorLabels, JLLlist, GVARlist, WishBC, BRWlist, Folder2Save</span>
<span id="cb3-88"><a href="#cb3-88" tabindex="-1"></a>)</span>
<span id="cb3-89"><a href="#cb3-89" tabindex="-1"></a></span>
<span id="cb3-90"><a href="#cb3-90" tabindex="-1"></a><span class="co"># 6) Out-of-sample forecasting</span></span>
<span id="cb3-91"><a href="#cb3-91" tabindex="-1"></a>Forecasts <span class="ot">&lt;-</span> <span class="fu">ForecastYields</span>(</span>
<span id="cb3-92"><a href="#cb3-92" tabindex="-1"></a>  ModelType, ModelParaList, InputsForOutputs, FactorLabels, Economies,</span>
<span id="cb3-93"><a href="#cb3-93" tabindex="-1"></a>  JLLlist, GVARlist, WishBC, BRWlist, Folder2Save</span>
<span id="cb3-94"><a href="#cb3-94" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="candelon-and-moura-2023" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Candelon and Moura (2023)</h1>
<p>In this paper, <span class="citation">Candelon and Moura (2023)</span> delve into an exploration of the underlying factors that shape the sovereign yield curves of Brazil, India, Mexico, and Russia in the midst of the COVID<span class="math inline">\(-19\)</span> pandemic crisis. To comprehensively address the intricate web of global macro-financial and particularly health-related interdependencies, the study employs a modeling approach based on a <em>GVAR multi</em> type framework. By delving into these aspects, the authors aim to provide a nuanced understanding of the dynamics influencing sovereign yield curves in these countries during the challenging circumstances of the pandemic.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># A) Load database data</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="fu">LoadData</span>(<span class="st">&quot;CM_2023&quot;</span>)</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="co"># B) GENERAL model inputs</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>ModelType <span class="ot">&lt;-</span> <span class="st">&quot;GVAR multi&quot;</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>Economies <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Brazil&quot;</span>, <span class="st">&quot;India&quot;</span>, <span class="st">&quot;Russia&quot;</span>, <span class="st">&quot;Mexico&quot;</span>)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>GlobalVar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;US_Output_growth&quot;</span>, <span class="st">&quot;China_Output_growth&quot;</span>, <span class="st">&quot;SP500&quot;</span>)</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>DomVar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Inflation&quot;</span>, <span class="st">&quot;Output_growth&quot;</span>, <span class="st">&quot;CDS&quot;</span>, <span class="st">&quot;COVID&quot;</span>)</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>t0_sample <span class="ot">&lt;-</span> <span class="st">&quot;22-03-2020&quot;</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>tF_sample <span class="ot">&lt;-</span> <span class="st">&quot;26-09-2021&quot;</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>OutputLabel <span class="ot">&lt;-</span> <span class="st">&quot;CM_EM&quot;</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>DataFreq <span class="ot">&lt;-</span> <span class="st">&quot;Weekly&quot;</span></span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>F2S <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>StatQ <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a></span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a><span class="co"># B.1) SPECIFIC model inputs</span></span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a><span class="do">#################################### GVAR-based models ##################################################</span></span>
<span id="cb4-23"><a href="#cb4-23" tabindex="-1"></a>GVARlist <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb4-24"><a href="#cb4-24" tabindex="-1"></a>  <span class="at">VARXtype =</span> <span class="st">&quot;constrained: COVID&quot;</span>, <span class="at">W_type =</span> <span class="st">&quot;Sample Mean&quot;</span>, <span class="at">t_First_Wgvar =</span> <span class="st">&quot;2015&quot;</span>,</span>
<span id="cb4-25"><a href="#cb4-25" tabindex="-1"></a>  <span class="at">t_Last_Wgvar =</span> <span class="st">&quot;2020&quot;</span>, <span class="at">DataConnectedness =</span> TradeFlows_covid</span>
<span id="cb4-26"><a href="#cb4-26" tabindex="-1"></a>)</span>
<span id="cb4-27"><a href="#cb4-27" tabindex="-1"></a><span class="do">###################################### BRW inputs  ######################################################</span></span>
<span id="cb4-28"><a href="#cb4-28" tabindex="-1"></a>WishBC <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb4-29"><a href="#cb4-29" tabindex="-1"></a></span>
<span id="cb4-30"><a href="#cb4-30" tabindex="-1"></a><span class="co"># C) Decide on Settings for numerical outputs</span></span>
<span id="cb4-31"><a href="#cb4-31" tabindex="-1"></a>WishFPremia <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb4-32"><a href="#cb4-32" tabindex="-1"></a>FPmatLim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">47</span>, <span class="dv">48</span>)</span>
<span id="cb4-33"><a href="#cb4-33" tabindex="-1"></a></span>
<span id="cb4-34"><a href="#cb4-34" tabindex="-1"></a>Horiz <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb4-35"><a href="#cb4-35" tabindex="-1"></a>DesiredGraphs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;GIRF&quot;</span>, <span class="st">&quot;GFEVD&quot;</span>, <span class="st">&quot;TermPremia&quot;</span>)</span>
<span id="cb4-36"><a href="#cb4-36" tabindex="-1"></a>WishGraphRiskFac <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb4-37"><a href="#cb4-37" tabindex="-1"></a>WishGraphYields <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb4-38"><a href="#cb4-38" tabindex="-1"></a>WishOrthoJLLgraphs <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb4-39"><a href="#cb4-39" tabindex="-1"></a></span>
<span id="cb4-40"><a href="#cb4-40" tabindex="-1"></a><span class="co"># D) Bootstrap settings</span></span>
<span id="cb4-41"><a href="#cb4-41" tabindex="-1"></a>WishBootstrap <span class="ot">&lt;-</span> <span class="cn">TRUE</span> <span class="co">#  YES: 1; No = 0.</span></span>
<span id="cb4-42"><a href="#cb4-42" tabindex="-1"></a>BootList <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">methodBS =</span> <span class="st">&quot;bs&quot;</span>, <span class="at">BlockLength =</span> <span class="dv">4</span>, <span class="at">ndraws =</span> <span class="dv">100</span>, <span class="at">pctg =</span> <span class="dv">95</span>)</span>
<span id="cb4-43"><a href="#cb4-43" tabindex="-1"></a></span>
<span id="cb4-44"><a href="#cb4-44" tabindex="-1"></a><span class="do">#########################################################################################################</span></span>
<span id="cb4-45"><a href="#cb4-45" tabindex="-1"></a><span class="do">############################### NO NEED TO MAKE CHANGES FROM HERE #######################################</span></span>
<span id="cb4-46"><a href="#cb4-46" tabindex="-1"></a><span class="do">#########################################################################################################</span></span>
<span id="cb4-47"><a href="#cb4-47" tabindex="-1"></a></span>
<span id="cb4-48"><a href="#cb4-48" tabindex="-1"></a><span class="co"># 2) Minor preliminary work: get the sets of factor labels and  a vector of common maturities</span></span>
<span id="cb4-49"><a href="#cb4-49" tabindex="-1"></a>FactorLabels <span class="ot">&lt;-</span> <span class="fu">LabFac</span>(N, DomVar, GlobalVar, Economies, ModelType)</span>
<span id="cb4-50"><a href="#cb4-50" tabindex="-1"></a></span>
<span id="cb4-51"><a href="#cb4-51" tabindex="-1"></a><span class="co"># 3) Prepare the inputs of the likelihood function</span></span>
<span id="cb4-52"><a href="#cb4-52" tabindex="-1"></a>ATSMInputs <span class="ot">&lt;-</span> <span class="fu">InputsForOpt</span>(</span>
<span id="cb4-53"><a href="#cb4-53" tabindex="-1"></a>  t0_sample, tF_sample, ModelType, Yields_covid, GlobalMacro_covid, DomMacro_covid, FactorLabels,</span>
<span id="cb4-54"><a href="#cb4-54" tabindex="-1"></a>  Economies, DataFreq, GVARlist</span>
<span id="cb4-55"><a href="#cb4-55" tabindex="-1"></a>)</span>
<span id="cb4-56"><a href="#cb4-56" tabindex="-1"></a></span>
<span id="cb4-57"><a href="#cb4-57" tabindex="-1"></a><span class="co"># 4) Optimization of the ATSM (Point Estimates)</span></span>
<span id="cb4-58"><a href="#cb4-58" tabindex="-1"></a>ModelParaList <span class="ot">&lt;-</span> <span class="fu">Optimization</span>(ATSMInputs, StatQ, DataFreq, FactorLabels, Economies, ModelType)</span>
<span id="cb4-59"><a href="#cb4-59" tabindex="-1"></a></span>
<span id="cb4-60"><a href="#cb4-60" tabindex="-1"></a><span class="co"># 5) Numerical and graphical outputs</span></span>
<span id="cb4-61"><a href="#cb4-61" tabindex="-1"></a><span class="co"># a) Prepare list of inputs for graphs and numerical outputs</span></span>
<span id="cb4-62"><a href="#cb4-62" tabindex="-1"></a>InputsForOutputs <span class="ot">&lt;-</span> <span class="fu">InputsForOutputs</span>(</span>
<span id="cb4-63"><a href="#cb4-63" tabindex="-1"></a>  ModelType, Horiz, DesiredGraphs, OutputLabel, StatQ, DataFreq,</span>
<span id="cb4-64"><a href="#cb4-64" tabindex="-1"></a>  WishGraphYields, WishGraphRiskFac, WishOrthoJLLgraphs, WishFPremia,</span>
<span id="cb4-65"><a href="#cb4-65" tabindex="-1"></a>  FPmatLim, WishBootstrap, BootList</span>
<span id="cb4-66"><a href="#cb4-66" tabindex="-1"></a>)</span>
<span id="cb4-67"><a href="#cb4-67" tabindex="-1"></a></span>
<span id="cb4-68"><a href="#cb4-68" tabindex="-1"></a><span class="co"># b) Fit, IRF, FEVD, GIRF, GFEVD, and Term Premia</span></span>
<span id="cb4-69"><a href="#cb4-69" tabindex="-1"></a>NumericalOutputs <span class="ot">&lt;-</span> <span class="fu">NumOutputs</span>(</span>
<span id="cb4-70"><a href="#cb4-70" tabindex="-1"></a>  ModelType, ModelParaList, InputsForOutputs, FactorLabels,</span>
<span id="cb4-71"><a href="#cb4-71" tabindex="-1"></a>  Economies, F2S</span>
<span id="cb4-72"><a href="#cb4-72" tabindex="-1"></a>)</span>
<span id="cb4-73"><a href="#cb4-73" tabindex="-1"></a></span>
<span id="cb4-74"><a href="#cb4-74" tabindex="-1"></a><span class="co"># c) Confidence intervals (bootstrap analysis)</span></span>
<span id="cb4-75"><a href="#cb4-75" tabindex="-1"></a>BootstrapAnalysis <span class="ot">&lt;-</span> <span class="fu">Bootstrap</span>(ModelType, ModelParaList, NumericalOutputs, Economies, InputsForOutputs,</span>
<span id="cb4-76"><a href="#cb4-76" tabindex="-1"></a>  FactorLabels,</span>
<span id="cb4-77"><a href="#cb4-77" tabindex="-1"></a>  <span class="at">JLLlist =</span> <span class="cn">NULL</span>, GVARlist, WishBC, BRWlist, F2S</span>
<span id="cb4-78"><a href="#cb4-78" tabindex="-1"></a>)</span></code></pre></div>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-AngPiazzesi2003JME" class="csl-entry">
Ang, Andrew, and Monika Piazzesi. 2003. <span>“A No-Arbitrage Vector Autoregression of Term Structure Dynamics with Macroeconomic and Latent Variables.”</span> <em>Journal of Monetary Economics</em> 50 (4): 745–87.
</div>
<div id="ref-BauerRudebusch2017" class="csl-entry">
Bauer, Michael D, and Glenn D Rudebusch. 2017. <span>“Resolving the Spanning Puzzle in Macro-Finance Term Structure Models.”</span> <em>Review of Finance</em> 21 (2): 511–53.
</div>
<div id="ref-CandelonMoura2023" class="csl-entry">
Candelon, Bertrand, and Rubens Moura. 2023. <span>“Sovereign Yield Curves and the COVID-19 in Emerging Markets.”</span> <em>Economic Modelling</em>, 106453. https://doi.org/<a href="https://doi.org/10.1016/j.econmod.2023.106453">https://doi.org/10.1016/j.econmod.2023.106453</a>.
</div>
<div id="ref-CandelonMoura2024" class="csl-entry">
———. 2024. <span>“A Multicountry Model of the Term Structures of Interest Rates with a GVAR.”</span> <em>Journal of Financial Econometrics</em> 22 (5): 1558–87.
</div>
<div id="ref-JoslinPriebschSingleton2014" class="csl-entry">
Joslin, Scott, Marcel Priebsch, and Kenneth J. Singleton. 2014. <span>“Risk Premiums in Dynamic Term Structure Models with Unspanned Macro Risks.”</span> <em>Journal of Finance</em> 69 (3): 1197–1233.
</div>
<div id="ref-JotikasthiraLeLundblad2015" class="csl-entry">
Jotikasthira, Chotibhak, Anh Le, and Christian Lundblad. 2015. <span>“Why Do Term Structures in Different Currencies Co-Move?”</span> <em>Journal of Financial Economics</em> 115: 58–83.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
