<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Rubens Moura" />

<meta name="date" content="2023-03-08" />

<title>MultiATSM package - General Guidelines</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<script>$(document).ready(function(){
    if (typeof $('[data-toggle="tooltip"]').tooltip === 'function') {
        $('[data-toggle="tooltip"]').tooltip();
    }
    if ($('[data-toggle="popover"]').popover === 'function') {
        $('[data-toggle="popover"]').popover();
    }
});
</script>
<style type="text/css">
.lightable-minimal {
border-collapse: separate;
border-spacing: 16px 1px;
width: 100%;
margin-bottom: 10px;
}
.lightable-minimal td {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal th {
margin-left: 5px;
margin-right: 5px;
}
.lightable-minimal thead tr:last-child th {
border-bottom: 2px solid #00000050;
empty-cells: hide;
}
.lightable-minimal tbody tr:first-child td {
padding-top: 0.5em;
}
.lightable-minimal.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-minimal.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic {
border-top: 0.16em solid #111111;
width: 100%;
margin-bottom: 10px;
margin: 10px 5px;
}
.lightable-classic caption {
color: #222222;
}
.lightable-classic td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic thead tr:last-child th {
border-bottom: 0.10em solid #111111;
}
.lightable-classic tbody tr:last-child td {
border-bottom: 0.14em solid #111111;
}
.lightable-classic.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-classic-2 {
border-top: 3px double #111111;
width: 100%;
margin-bottom: 10px;
}
.lightable-classic-2 caption {
color: #222222;
}
.lightable-classic-2 td {
padding-left: 5px;
padding-right: 5px;
color: #222222;
}
.lightable-classic-2 th {
padding-left: 5px;
padding-right: 5px;
font-weight: normal;
color: #222222;
}
.lightable-classic-2 tbody tr:last-child td {
border-bottom: 3px double #111111;
}
.lightable-classic-2 thead tr:last-child th {
border-bottom: 1px solid #111111;
}
.lightable-classic-2.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-classic-2.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #EEE;
border-collapse: collapse;
margin-bottom: 10px;
}
.lightable-material th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
}
.lightable-material td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
border-top: 1px solid #eeeeee;
}
.lightable-material.lightable-hover tbody tr:hover {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody tr:nth-child(even) {
background-color: #f5f5f5;
}
.lightable-material.lightable-striped tbody td {
border: 0;
}
.lightable-material.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #ddd;
}
.lightable-material-dark {
min-width: 100%;
white-space: nowrap;
table-layout: fixed;
font-family: Roboto, sans-serif;
border: 1px solid #FFFFFF12;
border-collapse: collapse;
margin-bottom: 10px;
background-color: #363640;
}
.lightable-material-dark th {
height: 56px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF60;
}
.lightable-material-dark td {
height: 52px;
padding-left: 16px;
padding-right: 16px;
color: #FFFFFF;
border-top: 1px solid #FFFFFF12;
}
.lightable-material-dark.lightable-hover tbody tr:hover {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody tr:nth-child(even) {
background-color: #FFFFFF12;
}
.lightable-material-dark.lightable-striped tbody td {
border: 0;
}
.lightable-material-dark.lightable-striped thead tr:last-child th {
border-bottom: 1px solid #FFFFFF12;
}
.lightable-paper {
width: 100%;
margin-bottom: 10px;
color: #444;
}
.lightable-paper thead tr:last-child th {
color: #666;
vertical-align: bottom;
border-bottom: 1px solid #00000020;
line-height: 1.15em;
padding: 10px 5px;
}
.lightable-paper td {
vertical-align: middle;
border-bottom: 1px solid #00000010;
line-height: 1.15em;
padding: 7px 5px;
}
.lightable-paper.lightable-hover tbody tr:hover {
background-color: #F9EEC1;
}
.lightable-paper.lightable-striped tbody tr:nth-child(even) {
background-color: #00000008;
}
.lightable-paper.lightable-striped tbody td {
border: 0;
}
</style>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">
/* for pandoc --citeproc since 2.11 */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">MultiATSM package - General Guidelines</h1>
<h4 class="author">Rubens Moura</h4>
<h4 class="date">2023-03-08</h4>


<div id="TOC">
<ul>
<li><a href="#S:SectionData"><span class="toc-section-number">1</span> Data</a>
<ul>
<li><a href="#S:SectionDataPackage"><span class="toc-section-number">1.1</span> Package data-set</a></li>
<li><a href="#S:SectionImport"><span class="toc-section-number">1.2</span> Import data from Excel files</a></li>
</ul></li>
<li><a href="#S:SectionInputs"><span class="toc-section-number">2</span> Required user inputs</a>
<ul>
<li><a href="#basic-inputs-used-in-the-model-estimation"><span class="toc-section-number">2.1</span> Basic inputs used in the model estimation</a></li>
<li><a href="#additional-inputs-for-numerical-and-graphical-outputs"><span class="toc-section-number">2.2</span> Additional inputs for numerical and graphical outputs</a></li>
</ul></li>
<li><a href="#S:SectionEstimation"><span class="toc-section-number">3</span> Model Estimation</a>
<ul>
<li><a href="#S:SpaFac"><span class="toc-section-number">3.1</span> Spanned Factors</a></li>
<li><a href="#the-p-dynamics-estimation"><span class="toc-section-number">3.2</span> The P-dynamics estimation</a></li>
<li><a href="#atsm-estimation"><span class="toc-section-number">3.3</span> ATSM estimation</a></li>
</ul></li>
<li><a href="#S:SectionReplication"><span class="toc-section-number">4</span> Examples of full implementation of ATSMs</a>
<ul>
<li><a href="#general-template"><span class="toc-section-number">4.1</span> General template</a></li>
<li><a href="#paper-replications"><span class="toc-section-number">4.2</span> Paper replications</a></li>
</ul></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<p>This document aims at providing general guidance on the use of the <em>MultiATSM</em> package available at the <a href="https://cran.r-project.org/">CRAN repository</a>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MultiATSM)</span></code></pre></div>
<p>The <em>MultiATSM</em> package provides several model outputs from various single and multi-country affine term structure of interest models (ATSMs). All the frameworks of this package are based on the unspanned economic risk framework from <span class="citation">Joslin, Priebsch, and Singleton (2014)</span> (JPS, 2014). In essence, these models assume the absence of arbitrage opportunities, consider a linear state space representation of the yield curve dynamics and offer a tractable approach to simultaneously combine the traditional yield curve factors (spanned factors) along with economic and financial variables (unspanned factors).</p>
<p>Due to the peculiar features of the JPS specification, an efficient estimation of the parameters governing the risk-neutral (<span class="math inline">\(Q\)</span>-measure) and the physical (<span class="math inline">\(P\)</span>-measure) probability measures can be carried out rather independently. The only exception is the variance-covariance matrix (sigma) term which is a common element to both the <span class="math inline">\(P\)</span> and the <span class="math inline">\(Q\)</span> density functions.</p>
<p>In its current version, the <em>MultiATSM</em> package can generate the outputs of 8 different classes of ATSMs. More specifically, the <em>MultiATSM</em> includes models in which the estimation is done on a <em>country-by-country</em> basis - as in JPS (2014) - or <em>jointly</em> for all the countries of the economic system - as in <span class="citation">Jotikasthira, Le, and Lundblad (2015)</span> (JLL, 2015) and <span class="citation">Candelon and Moura (2021)</span> (CM, 2021). In all cases, the risk factor dynamics under the <span class="math inline">\(P\)</span>-measure follow a VAR(1) model of some sort. The table below summarizes the general features of each one of the models available at this package.</p>
<table class=" lightable-classic lightable-striped" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:ModFea">Table 0.1: </span>Model Features
</caption>
<thead>
<tr>
<th style="empty-cells: hide;" colspan="2">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; font-weight: bold; " colspan="5">
<div style="TRUE">
P-dynamics
</div>
</th>
<th style="empty-cells: hide;" colspan="2">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; font-weight: bold; " colspan="2">
<div style="TRUE">
Q-dynamics
</div>
</th>
<th style="empty-cells: hide;" colspan="2">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; font-weight: bold; " colspan="2">
<div style="TRUE">
Sigma matrix estimation
</div>
</th>
<th style="empty-cells: hide;" colspan="2">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; font-weight: bold; " colspan="1">
<div style="TRUE">
Dominant Country
</div>
</th>
</tr>
<tr>
<th style="empty-cells: hide;" colspan="2">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="TRUE">
Individual
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="3">
<div style="TRUE">
Joint
</div>
</th>
<th style="empty-cells: hide;" colspan="2">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="TRUE">
Individual
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="TRUE">
Joint
</div>
</th>
<th style="empty-cells: hide;" colspan="2">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="TRUE">
P only
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="TRUE">
P and Q
</div>
</th>
<th style="empty-cells: hide;" colspan="3">
</th>
</tr>
<tr>
<th style="empty-cells: hide;" colspan="2">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="TRUE">
Unrestricted
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="TRUE">
Restricted
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="1">
<div style="TRUE">
Unrestricted
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; " colspan="2">
<div style="TRUE">
Restricted
</div>
</th>
<th style="empty-cells: hide;" colspan="11">
</th>
</tr>
<tr>
<th style="text-align:left;font-size: 10px;">
</th>
<th style="text-align:center;font-size: 10px;">
</th>
<th style="text-align:center;font-size: 10px;">
</th>
<th style="text-align:center;font-size: 10px;">
</th>
<th style="text-align:center;font-size: 10px;">
</th>
<th style="text-align:center;font-size: 10px;">
JLL
</th>
<th style="text-align:center;font-size: 10px;">
GVAR
</th>
<th style="text-align:center;font-size: 10px;">
</th>
<th style="text-align:center;font-size: 10px;">
</th>
<th style="text-align:center;font-size: 10px;">
</th>
<th style="text-align:center;font-size: 10px;">
</th>
<th style="text-align:center;font-size: 10px;">
</th>
<th style="text-align:center;font-size: 10px;">
</th>
<th style="text-align:center;font-size: 10px;">
</th>
<th style="text-align:center;font-size: 10px;">
</th>
<th style="text-align:center;font-size: 10px;">
</th>
<th style="text-align:center;font-size: 10px;">
</th>
<th style="text-align:center;font-size: 10px;">
</th>
</tr>
</thead>
<tbody>
<tr grouplength="3">
<td colspan="18" style="background-color: #666; color: #fff;">
<strong>Unrestricted VAR</strong>
</td>
</tr>
<tr>
<td style="text-align:left; padding-left:  2em;" indentlevel="1">
JPS
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
x
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
x
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
x
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left:  2em;" indentlevel="1">
JPS jointP
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
x
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
x
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
x
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left:  2em;" indentlevel="1">
VAR jointQ
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
x
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
x
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
x
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr grouplength="2">
<td colspan="18" style="background-color: #666; color: #fff;">
<strong>Restricted VAR (GVAR)</strong>
</td>
</tr>
<tr>
<td style="text-align:left; padding-left:  2em;" indentlevel="1">
GVAR sepQ
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
x
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
x
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
x
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left:  2em;" indentlevel="1">
GVAR jointQ
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
x
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
x
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
x
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr grouplength="3">
<td colspan="18" style="background-color: #666; color: #fff;">
<strong>Restricted VAR (JLL)</strong>
</td>
</tr>
<tr>
<td style="text-align:left; padding-left:  2em;" indentlevel="1">
JLL original
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
x
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
x
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
x
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
x
</td>
</tr>
<tr>
<td style="text-align:left; padding-left:  2em;" indentlevel="1">
JLL NoDomUnit
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
x
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
x
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
x
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
</tr>
<tr>
<td style="text-align:left; padding-left:  2em;" indentlevel="1">
JLL jointSigma
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
x
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
x
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
x
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
</td>
<td style="text-align:center;">
x
</td>
</tr>
</tbody>
</table>
<p>Some aspects of the multi-country frameworks are worth highlighting. As for the models based on the setup of JLL (2015), the version “JLL original” follows closely the seminal work of JLL (2015), i.e., it is assumed an economic cohort containing a worldwide dominant economy and a set of smaller countries, in addition to the estimation of the sigma matrix be performed exclusively under the <span class="math inline">\(P\)</span>-measure. The two other alternative versions assume the absence of a dominant country (“JLL NoDomUnit”) and the estimation of sigma under both the <span class="math inline">\(P\)</span> and <span class="math inline">\(Q\)</span> measures (“JLL jointSigma”), as in the standard JPS (2014) model. As for the remaining multi-country ATSMs, it is considered that the dynamics of the risk factors under the <span class="math inline">\(P\)</span>-measure evolves according to a GVAR model. The version labeled “GVAR jointQ” is the one presented in CM (2021).</p>
<p>In what follows, the focus will be devoted to describe the various pieces that are necessary to implement ATSMs. Specifically, Section <a href="#S:SectionData">1</a> describes the data-set available at this package and the set of functions that are useful to retrieve data from Excel files. Section <a href="#S:SectionInputs">2</a> exposes the necessary inputs that have to be specified by the user. In Section <a href="#S:SectionEstimation">3</a> the estimation procedure is detailed. Section <a href="#S:SectionReplication">4</a> shows how to use the <em>MultiATSM</em> package to estimate ATSMs from scratch as well as to closely reproduce some empirical features of academic papers. To ease the exposition, throughout the next sections, the database used by CM (2021) is employed to illustrate the use of the various functions available in this package.</p>
<div id="S:SectionData" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Data</h1>
<div id="S:SectionDataPackage" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> Package data-set</h2>
<p>The <em>MultiATSM</em> package contains the four data-sets used in CM (2021). The first set of data comprises several time series of zero-coupon bond yields from four emerging markets: China, Brazil, Mexico, and Uruguay. It is worth noting that this package requires <em>(i)</em> for estimation purposes, the maturities of the bond yields to be the same for all countries (although the function <em>DataForEstimation</em> handles different maturities across countries as inputs, the outputs generated by this same function are bond yields of the same maturities for all the economies); <em>(ii)</em> bond yields to be expressed in percentage terms (and not in basis points) per annum. The <em>MultiATSM</em> package does not support a routine to bootstrap zero-coupon yields from coupon bonds. This data manipulation procedure must be handled by the user herself, if necessary.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&#39;CM_Yields&#39;</span>)</span></code></pre></div>
<p>The second group of data concerns the time series of the risk factors. Specifically, along the terminology defined in JPS (2014), this data-set contains <em>(i)</em> country-specific spanned factors (denoted by level, slope, and curvature - see Section <a href="#S:SpaFac">3.1</a> for a more detailed description) and <em>(ii)</em> an array of country-specific and global unspanned factors (namely, some measure of economic growth and inflation). Similarly to the case of the bond yield data, the measures of economic and financial variables must be constructed by the user.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&#39;CM_Factors&#39;</span>)</span></code></pre></div>
<p>The two last blocks of data are necessary for the estimation of the GVAR-based models. The trade flows database
presents the sum of the value of all goods imports and exports between any two countries of the sample on a yearly basis since 1948. All the values are free on board and are expressed in U.S. dollars. These data are used to construct the transition matrix of the GVARs models.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&#39;CM_Trade&#39;</span>)</span></code></pre></div>
<p>The GVAR factors database casts country-specific lists of all the factors that are used in the estimation of each country’s VARX(1,1,1). The function titled <em>DatabasePrep</em> provides assistance to structure the data in a similar fashion to this form. Moreover, a specific function for computing the star risk factors is detailed in the Section <a href="#S:SectionGVAR">3.2.2</a>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&#39;CM_Factors_GVAR&#39;</span>)</span></code></pre></div>
</div>
<div id="S:SectionImport" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Import data from Excel files</h2>
<p>This package also offers an automatized procedure to extract data from Excel files and to, subsequentially, prepare the risk factor databases that are directly used in the model estimation. The use of the package functions requires that the databases <em>(i)</em> are constructed in separate Excel files for the unspanned factors, the term structure data, and the measures of interdependence (for the GVAR-based models); <em>(ii)</em> contain, in each Excel file, one separate tab per country (in addition to the global variables, in the case of the unspanned factors’ database); and <em>(iii)</em> have identical variable labels across all the tabs within each file. For illustration, see the Excel file available at the package.
One example of list of inputs to be provided is, for instance,</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>Initial_Date <span class="ot">&lt;-</span> <span class="st">&quot;2006-09-01&quot;</span> <span class="co"># Format &quot;yyyy-mm-dd&quot;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>Final_Date <span class="ot">&lt;-</span> <span class="st">&quot;2019-01-01&quot;</span> <span class="co"># Format &quot;yyyy-mm-dd&quot;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>DataFrequency <span class="ot">&lt;-</span> <span class="st">&quot;Monthly&quot;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>GlobalVar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;GBC&quot;</span>, <span class="st">&quot;VIX&quot;</span>) <span class="co"># Global Variables</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>DomVar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Eco_Act&quot;</span>, <span class="st">&quot;Inflation&quot;</span>, <span class="st">&quot;Com_Prices&quot;</span>, <span class="st">&quot;Exc_Rates&quot;</span>) <span class="co">#  Domestic variables</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span>  <span class="dv">3</span> <span class="co"># Number of spanned factors per country</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>Economies <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;China&quot;</span>, <span class="st">&quot;Mexico&quot;</span>, <span class="st">&quot;Uruguay&quot;</span>, <span class="st">&quot;Brazil&quot;</span>, <span class="st">&quot;Russia&quot;</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>ModelType <span class="ot">&lt;-</span> <span class="st">&quot;JPS&quot;</span></span></code></pre></div>
<p>Based on these inputs, one can construct the variable <em>ZZfull</em> which contains the complete set of the model risk factors.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>FactorLabels <span class="ot">&lt;-</span> <span class="fu">LabFac</span>(N, DomVar, GlobalVar, Economies, ModelType)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>ZZfull <span class="ot">&lt;-</span><span class="fu">DataForEstimation</span>(Initial_Date, Final_Date, Economies, N, FactorLabels, ModelType, DataFrequency)</span></code></pre></div>
</div>
</div>
<div id="S:SectionInputs" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Required user inputs</h1>
<div id="basic-inputs-used-in-the-model-estimation" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Basic inputs used in the model estimation</h2>
<p>In order to estimate any ATSM of this package, the user needs to specify several general model inputs, namely:</p>
<ul>
<li><strong>Model type</strong>: a string-vector containing the label of the model to be estimated (as per described in Table <a href="#tab:ModFea">0.1</a>);</li>
<li><strong>Model parameters corrected for bias</strong>: following the bias correction method described in <span class="citation">Bauer, Rudebusch, and Wu (2012)</span> (BRW, 2012), this variable assumes value equal to “1” if the user wishes to implement the framework of BRW (2012) and “0”, otherwise;</li>
<li><strong>Frequency of the data</strong>: a string-vector that specifies the frequency of the time series data. The available options are: <em>“Annually”</em>, <em>“Quarterly”</em>, <em>“Monthly”</em>, <em>“Weekly”</em>, <em>“Daily Business Days”</em>, and <em>“Daily All Days”</em>;</li>
<li><strong>Economies</strong>: a string-vector containing the names of the economies which are part of the economic system;</li>
<li><strong>Number of spanned factors (N)</strong>: number of country-specific spanned factors. In this package, <em>N</em> is assumed to be equal across countries;</li>
<li><strong>Global variables</strong>: a string-vector containing the labels of the global unspanned factors used in the model estimation;</li>
<li><strong>Domestic variables</strong>: a string-vector containing the labels of the domestic unspanned factors used in the model estimation;</li>
<li><strong>Bond yield set of maturities</strong>: a numerical-vector containing the maturities of the yields used in the model estimation. The units of this vector must be expressed in <em>years</em>. Alternatively, the user can rely on the <em>Maturities</em> routine to extract the bond maturities from the time series of bond yields (see the documentation of the <em>Maturities</em> function). In this case, the user must specify the <strong>unit of time in which the label of the bond yields</strong> are expressed, e.g. if the label of the 10-years bond is selected as <em>Y120M</em> (<em>Y10y</em>), then the option <em>Month</em> (<em>Year</em>) must be selected;</li>
<li><strong>Stationarity constraint under the <span class="math inline">\(Q\)</span>-dynamics</strong>: a binary variable which takes value equal to “1” if the user wishes the largest eigenvalue under the <span class="math inline">\(Q\)</span>-measure to be strictly smaller than 1. Otherwise, this same variable must be set to “0”;</li>
<li><strong>Computation of forward premia</strong>: this is another binary variable which takes the value equal to “1” if the user wishes the computation of the forward premia or “0”, otherwise. If the this variable is set to “1”, then the user must specify a two-element numerical vector containing the maturties associated with the starting and the ending date of the loan;</li>
<li><strong>Output label</strong>: a single element string-vector which contains the of the name that appears in the file name that stores the model outputs.</li>
</ul>
<p>One possible example of the basic model inputs is</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ModelType <span class="ot">&lt;-</span> <span class="st">&quot;JPS&quot;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>BiasCorrection <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># 1 = estimate model with bias correction; 0 = estimate model without bias correction</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>DataFrequency <span class="ot">&lt;-</span> <span class="st">&quot;Monthly&quot;</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>UnitMatYields <span class="ot">&lt;-</span> <span class="st">&quot;Month&quot;</span> <span class="co"># Available options are: &quot;Month&quot; or &quot;Year&quot;.</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>Economies <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;China&quot;</span>, <span class="st">&quot;Brazil&quot;</span>, <span class="st">&quot;Mexico&quot;</span>, <span class="st">&quot;Uruguay&quot;</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># number of spanned factors per country</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>GlobalVar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;GBC&quot;</span>, <span class="st">&quot;CPI_OECD&quot;</span>) <span class="co"># Global variables</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>DomVar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Eco_Act&quot;</span>, <span class="st">&quot;Inflation&quot;</span>) <span class="co"># Domestic variables </span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">10</span>) <span class="co"># vector of maturities</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>StationarityUnderQ <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># 1 = set stationarity condition under  the Q; 0 = no stationarity condition</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>WishForwardPremia <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># Wish to estimate the forward premia: 1= Yes; 0= No</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>FPmatLim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">60</span>,<span class="dv">120</span>) <span class="co"># maturty of the loan starts in 60 months and ends in 120 months in the future</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>OutputLabel <span class="ot">&lt;-</span> <span class="st">&quot;Model_demo&quot;</span> <span class="co"># output label</span></span></code></pre></div>
<div id="S:SectionGVARJLLinputs" class="section level3" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> GVARinputs and JLLinputs</h3>
<p>Some additional inputs are required if the user intends to estimate the GVAR-ATSM or JLL-ATSM related setups. The extra inputs should be stored in separate lists for each model for convenience. To assist the user in executing this task, one can use the <em>ListModelInputs</em> function. Otherwise, the <em>GVARinputs</em> and <em>JLLinputs</em> constructs can be formed manually as specified below.</p>
<p>To GVAR models, the set of supplementary inputs include:</p>
<ul>
<li><strong>Economies</strong>: a string-vector containing the names of the economies as described above;<br />
</li>
<li><strong>GVAR list of risk factors</strong>: a list of risk factors sorted by country in addition to the global variables. See function <em>DatabasePrep</em>;</li>
<li><strong>VARX type</strong>: a string-vector containing the desired estimated form of the VARX(1,1,1). Two possibilities are available. The <em>“unconstrained”</em> form estimates the model without any constrains, using standard OLS regressions for each model equation. The <em>“constrained: Spanned Factors”</em> form prevents foreign-spanned-factors to impact any domestic factor in the feedback matrix, whereas <em>“constrained: ’</em> followed by the name of the risk factor restricts this same factor to be influenced only by its own lagged values and the lagged values of its own star variables. In the last two cases, the VARX(1,1,1) is estimated by restricted least squares.</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>GVARinputs <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>GVARinputs<span class="sc">$</span>Economies <span class="ot">&lt;-</span> Economies</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>GVARinputs<span class="sc">$</span>GVARFactors <span class="ot">&lt;-</span> FactorsGVAR</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>GVARinputs<span class="sc">$</span>VARXtype <span class="ot">&lt;-</span> <span class="st">&quot;constrained: Inflation&quot;</span></span></code></pre></div>
<p>Furthermore, the estimation of the GVAR requires the specification of the necessary inputs to build the <strong>transition matrix</strong> (see Section <a href="#S:SectionGVAR">3.2.2</a> for more details). One example of this list of inputs is</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>t_First <span class="ot">&lt;-</span> <span class="st">&quot;2000&quot;</span> <span class="co"># First year of the sample</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>t_Last <span class="ot">&lt;-</span>  <span class="st">&quot;2015&quot;</span> <span class="co"># Last year of the sample</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>W_type <span class="ot">&lt;-</span> <span class="st">&#39;Sample Mean&#39;</span> </span></code></pre></div>
<p>Concerning the JLL-ATSM frameworks, the list of inputs includes:</p>
<ul>
<li><strong>JLL type</strong>: a string-vector containing the label of the JLL model to be estimated (as described in Table <a href="#tab:ModFea">0.1</a>);</li>
<li><strong>Economies</strong>: a string-vector containing the names of the economies as described above;</li>
<li><strong>Dominant Country</strong>: a string-vector containing the name of the economy which is assigned as the dominant country (applicable for the <em>JLL original</em> and <em>JLL jointSigma</em> models) or “None” (applicable for the <em>JLL NoDomUnit</em>).</li>
<li><strong>Wish the estimation of the sigmas matrices</strong>: this is a binary variable which assumes value equal to 1 if the user wishes the estimation of all JLL sigma matrices (i.e. variance-covariance and the Cholesky factorization matrices) and, 0 otherwise. The estimation of the sigma matrices can take several minutes;</li>
<li><strong>Sigma of the non-orthogonalized variance-covariance matrix</strong>: to save time, the user may provide the variance-covariance matrix from the non-orthogonalized dynamics. Otherwise, this input should be set as <em>NULL</em>.</li>
</ul>
<p>One possible list of JLL inputs is as follows:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>  JLLinputs <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  ModelType <span class="ot">&lt;-</span> <span class="st">&quot;JLL original&quot;</span>  </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  JLLinputs<span class="sc">$</span>Economies <span class="ot">&lt;-</span> Economies</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  JLLinputs<span class="sc">$</span>DomUnit <span class="ot">&lt;-</span> <span class="st">&quot;China&quot;</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  JLLinputs<span class="sc">$</span>WishSigmas <span class="ot">&lt;-</span> <span class="dv">1</span> </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  JLLinputs<span class="sc">$</span>SigmaNonOrtho <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>  JLLinputs<span class="sc">$</span>JLLModelType <span class="ot">&lt;-</span> ModelType</span></code></pre></div>
</div>
<div id="S:SectionBRWinputs" class="section level3" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> BRWinputs</h3>
<p>In an influential paper, BRW (2012) have shown that the estimates from traditional ATSMs can be severely biased due to the typical small-sample size used in these studies. As result, such models may produce
unreasonably stable expected future short-term interest, therefore distorting the term premia estimates for long-maturity bonds. To circumvent this problem, BRW (2012) propose a bootstrap-based method that relies on indirect inference estimation that corrects for the bias present in previous works.</p>
<p>From its version <span class="math inline">\(0.3.1\)</span>, the <em>MultiATSM</em> package accomodates the framework proposed by BRW (2012) to each one of its ATSM types. Some additional inputs must be specified, if the user intends to perform the model estimation along the lines of BRW (2012). They are:</p>
<ul>
<li><strong>Mean or median of OLS estimates</strong>: the user must decide whether to compute the mean or median of the OLS estimates after each bootstrap iteration. To compute the mean (median), the user must set <em>TRUE</em> (<em>FALSE</em>);</li>
<li><strong>Number of iteration</strong>: total amount of iterations used in the stochatic approximation algorithm after burn-in;</li>
<li><strong>Number of burn-in iteration</strong>: quantity of the iterations to be discarded in the first stage of the bias-correction estimation process. The recommended number is <span class="math inline">\(15\%\)</span> of the total number of iterations;</li>
<li><strong>Number of bootstrap samples</strong>: quantity of simulated samples used in each burn-in or actual iteration</li>
<li><strong>Adjustment parameter</strong>: this parameter controls the degree of shrinkage between the difference in the OLS estimates and the BRW (2012)’s bootstrap-based one after each iteration. The value of this parameter is fixed and must lie in the interval <span class="math inline">\(]0;1[\)</span>;</li>
<li><strong>Perform closeness check</strong>: flag whether the user wishes to check the root mean square distance between the model estimates produced by the bias-correction method and those generated by OLS. Default is set to <em>TRUE</em>;</li>
<li><strong>Number of bootstrap samples used in the closeness check</strong>: default is set to 100,000;</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>flag_mean <span class="ot">&lt;-</span> <span class="cn">TRUE</span> <span class="co"># TRUE = compute the mean; FALSE = compute the median</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="fl">0.2</span> <span class="co"># Adjustment parameter</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>N_iter <span class="ot">&lt;-</span> <span class="dv">500</span> <span class="co"># Number of iteration to be conserved </span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>N_burn <span class="ot">&lt;-</span> N_iter<span class="sc">*</span><span class="fl">0.15</span>  <span class="co"># Number of iteration to be discarded </span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="co"># Number of bootstrap samples </span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>checkBRW <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># Closeness check</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>B_check <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># Number of bootstrap samples used in the closeness check</span></span></code></pre></div>
</div>
</div>
<div id="additional-inputs-for-numerical-and-graphical-outputs" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Additional inputs for numerical and graphical outputs</h2>
<p>Once the model parameters from the ATSM have been estimated, the <em>MultiATSM</em> package enables the numerical and graphical compilation of the following additional outputs:</p>
<ul>
<li>Model fit of the bond yields;</li>
<li>Impulse response functions (IRFs);</li>
<li>Forecast error variance decompositions (FEVDs);</li>
<li>Generalized impulse response functions (GIRFs);</li>
<li>Generalized forecast error variance decompositions (GFEVDs);</li>
<li>Bond yields decomposition into their expected component and term premia.</li>
</ul>
<p>For the IRFs, GIRFs, FEVDs or GFEVDs, a horizon of analysis has to be specified, e.g.:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>Horiz <span class="ot">&lt;-</span> <span class="dv">100</span></span></code></pre></div>
<p>For the graphical outputs, the user must indicate the desired types of graphs in a string-based vector:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>DesiredGraphs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Fit&quot;</span>, <span class="st">&quot;GIRF&quot;</span>, <span class="st">&quot;GFEVD&quot;</span>) <span class="co"># Available options are: &quot;Fit&quot;, &quot;IRF&quot;, &quot;FEVD&quot;, &quot;GIRF&quot;, </span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                                          <span class="co"># &quot;GFEVD&quot;, &quot;TermPremia&quot;.</span></span></code></pre></div>
<p>Moreover, the user must select the types of variables of interest (yields, risk factors or both) and, for the JLL type of models, whether the orthogonalized version should be additionally included</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>WishGraphRiskFac <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co">#   YES: 1; No = 0.</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>WishGraphYields <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co">#    YES: 1; No = 0.</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>WishOrthoJLLgraphs <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># YES: 1; No = 0.</span></span></code></pre></div>
<p>The function <em>InputsForOutputs</em> can provide some guidance for customizing the features of the wished outputs. Conditional to these settings, individual folders are created at your <em>temporary directory</em> to store the different types of the desired graphical outputs.</p>
<div id="bootstrap-settings" class="section level3" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Bootstrap settings</h3>
<p>If the user intends to generate confidence bands through some bootstrap procedure, an additional list of inputs is required. Specifically:</p>
<ul>
<li><strong>methodBS</strong>: the desired bootstrap procedure. Available options are <em>(i)</em> standard residual bootstrap (‘bs’); <em>(ii)</em> wild bootstrap (‘wild’), and block bootstrap (‘block’). If the latest is selected, then the block length must be indicated;</li>
<li><strong>ndraws</strong>: the number of bootstrap draws;</li>
<li><strong>pctg</strong>: the confidence level expressed in percentage points.</li>
</ul>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>Bootlist <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>Bootlist<span class="sc">$</span>methodBS <span class="ot">&lt;-</span> <span class="st">&#39;block&#39;</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>Bootlist<span class="sc">$</span>BlockLength <span class="ot">&lt;-</span> <span class="dv">4</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>Bootlist<span class="sc">$</span>ndraws <span class="ot">&lt;-</span>  <span class="dv">3</span>  </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>Bootlist<span class="sc">$</span>pctg   <span class="ot">&lt;-</span>  <span class="dv">95</span> </span></code></pre></div>
</div>
<div id="out-of-sample-forecast-settings" class="section level3" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Out-of-sample forecast settings</h3>
<p>To perform out-of-sample forecasts of bond yields, the following list-based features have to be detailed:</p>
<ul>
<li><strong>ForHoriz</strong>: number of periods-ahead that the forecasts are to be generated;</li>
<li><strong>t0Sample</strong>: time-dimension index of the first observations belonging to the information set;</li>
<li><strong>t0Forecast</strong>: time-dimension index of the last observation of the information set used to perform the first forecast set.</li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>ForecastList <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>ForecastList<span class="sc">$</span>ForHoriz <span class="ot">&lt;-</span> <span class="dv">12</span> <span class="co"># forecast horizon</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>ForecastList<span class="sc">$</span>t0Sample <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># initial sample date</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>ForecastList<span class="sc">$</span>t0Forecast <span class="ot">&lt;-</span> <span class="dv">70</span> <span class="co"># last sample date for the first forecast</span></span></code></pre></div>
</div>
</div>
</div>
<div id="S:SectionEstimation" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Model Estimation</h1>
<p>Having gathered bond yields and other economic time series data, the ATSM estimation is carried out in three steps. Firstly, one needs to provide the number of country-specific spanned factors to be included in the global ATSM. Secondly, it is decided on the form of the risk factor dynamics under the <span class="math inline">\(P\)</span>-measure. Finally, the user needs to select the general features for the model optimization.</p>
<div id="S:SpaFac" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Spanned Factors</h2>
<p>The spanned factors are yield-related variables that are used to fit the cross-section dimensions of the term structures. Typically, the spanned factors of country <span class="math inline">\(i\)</span>, <span class="math inline">\(P_{i,t}\)</span>, are computed as the <em>N</em> first principal components (PCs) of the set of observed bond yields. Formally, <span class="math inline">\(P_{i,t}\)</span> is constructed as <span class="math inline">\(P_{i,t} = w_i Y_{i,t}\)</span> where <span class="math inline">\(w_i\)</span> is the PC weight matrix and <span class="math inline">\(Y_{i,t}\)</span> is a country-specific column-vector of yields with increasing maturities.</p>
<p>For <em>N=3</em>, the spanned factors are traditionally interpreted as level, slope, and curvature. The nature of such interpretability results from the features of the PC weight matrix as illustrated below:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">pca_weights_one_country</span>(Yields, <span class="at">Economy =</span> <span class="st">&quot;Uruguay&quot;</span>) </span></code></pre></div>
<p>In matrix <em>w</em>, each row stores the weights used for constructing each spanned factor. The entries of the first row are linked to the composition of the <em>level</em> factor in that they load rather equally on all yields. Accordingly, high (low) values of the level factor indicate an overall high (low) value of yields across all maturities. In the second row, the weights monotonically increase with the maturities and, therefore, they capture the degree of steepness (<em>slope</em>) of the term structure. High slope factor values imply a steep yield curve, whereas low ones entail flat (or, possibly, downward) curves. In the third row, the weights of the <em>curvature</em> factor are presented. The name of this factor follows from the fact that the weights have a more pronounced effect on the middle range maturities of the curve. These concepts are graphically illustrated below.</p>
<div class="figure"><span id="fig:unnamed-chunk-19"></span>
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAABCFBMVEUAAAAAADoAAGYAAP8AOmYAOpAAZmYAZrYA/wAzMzM6AAA6ADo6AGY6OmY6OpA6ZrY6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmAGZmOgBmOjpmOmZmOpBmZmZmkJBmtrZmtttmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2OyP+QOgCQOjqQOmaQkDqQkGaQtpCQ27aQ2/+rbk2rbm6rbo6ryKur5OSr5P+2ZgC2Zjq225C22/+2/9u2///Ijk3I///bkDrbtmbb25Db27bb2//b/7bb///kq27k////AAD/tmb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T///8/hN8gAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAK7UlEQVR4nO3dCXvbRBoHcCVQnKaBdQpNYSmHuVKg5vSyCwHWrblS4hriuvP9vwlzyDpsSe8c7xyK3v/zNL5mdPw8M5JTT5QxSmey2BuQeggICAEBISAgBASEgIAQEBACAkJAQAgICAEBISAgBASEgIAQEBACAkJAQAgICAEBISAgBASEgIB4A1q9dmn0/F6WWZZN9IvvZTMV9ZuzfqC91GSBVidztrozswbaTMdsfX9mtnEN8Q3E28GILcZM/JP3tYFUOX6zyLIxW736Fq+sFqFf/7ff+c3mixmvffiV2gi+tBFvXLd+LV6Ydy7UCeilvezuoPh5Mcm3cnu/KHO0l8rCL7LDuVjArydz3hJ4Y9pMJ2oRRZGr/RSvLUfbzRCrvjNjxUas35zzn7UXqgvFBOqKghADCX//f5yt/pXfN2jd67NDviu/8D1Vrotxvjid1IHESuVGsNVxdjArgfgL3Qv1DTTKt5a/Req+0aCyGO8AafYvVu2iov2JB2ojDufqcflC90I9A6mewdZvvz1nZS/RCd8TJovXuphanE7kIH025mP9dqiXG8E1lqoFFS90L9Qf0HEmxr58ALwQP4wGaTGaisFZDtIT80Ga68iOc5G9/O/8WCg2gj/7ytlkfXbrsnzB3yAdMPbnQ44hICB9AYoWAgJCQEAICAgBASEgIAQEhICAEBAQAgJCQEAICAgBASEgIAQEhICAEBAQAgJCQEAICAgBASEgIAQEhICAEBAQAgKiATRsQwICQkBACAgIAQEhICAEBISAgBBQJUcNzxHQNvXv+RchIJkWHUZAIu06jIC6ddjAgY4gHTZkIA0ckYECaeqwYQLp67ABAhnpsKEBmeqwQQFZ6LDhANnpsIEAWeuwAQDpnAx2JSxQZV57kDjiiAQFulJ/CwBted1B0GHhgeRNACMcHRYWqMLityGh6bBoQPKhHyNMHRYUqIEDvSEh67DYQPJpNCN8HRYSqIMBw8iLDgsIBBA4dTbXk8GupAIki1gZecQRCQWkueumDcmzDksOSBbVNfKvw4IBGfYdjYYURIelCiSrdNQJpcNCAdkdoFpqBdRhgYBsD+AN9cLqsJ4BBddhYYDszwArNX2eDHbFHqjtT3Dux+FzRF41Eo6IOVAzSeufLHXykZUj6rCdvX/+8PSNP/P7L/7zqKEI0Faq5Ypc6VZqytFVTB1W33th8vRe/uDpaROQRWQD0u2N9ci2E/j3/Lup7v3zz56w64+eyPvXH3+OCVSNrlTesxICuv7kT/b80x/E3Rfffa+62O3bt92AOvavW6roWnGFqnv/7I0C6Ol58xhkHK29a5KqDD1RhZpbEL8XEqhIKVUbmmMKNY9BT09FzveLmMZ2147qZw1X+3/7vCsOG7yX+lHsvDyK4bQgS6DdQ7vhYsw4u2UbzoNUI0IBQvKJ2cn8fhaz2q/GE+doQl6B7HwQl4UQn0CYPtGEUgPq+OQVR8gjELIPAbFun0hC/oDQfeIIpQQE/+YngpA3IB8+MYR8AfnxiSCUDJDmb1ZvCpAvn/BCiQAZ/GY+sJAfII8+oYVSADL9f6+gQl6ADH38Lt4xPoA8+4QVig5k9R+nAYU8APn3CSkUGcj6P96DCeEDBfEJJxQVyOWLG70FCuQTTAgbKJhPKKF4QO5fjAoihAwU0ieMUCwglC/W9Q8orE8QoShAeF9b9S+ECqTro71AtFXaBxMogo9/ofBA2N979iyECBTH56YBefjevF8hPKBYPp6FwgJ5mnfhUwgNKKKPV6GQQB7n7fgTwgKK65M+UOQpOR43IByQ54lxvoRwgOL7eBMKBRRgYqUfoZY5q9XZqzBQEj4BgMo5q7XZqwhAYSbmehFqni9Wnb0KAyXi40eodcZhfk/MWR1kmoDKOauV2atwC4Let5AT3/HbENSCGAgU/RyxFvStcR+DUmpAnoHKOau12avdQGn54Au1zFnVPw8CNij8X95AFnI9k07OB1vIEShBH2Qhr0CR/rJNQkBJ+uAKOQEl6oMq5AKU1iliLXib5g8o7p/WQhNyAErZB0/IHihtn9SBovugCVkDpe6DJWQLlL4PkpAPoER8cIQsgRI+BaoGYTPtgPrQwURiAfXFB0MIHSgpHwQhG6Ae+bgLWQD1ysdZCBcoQZ/wQD3zcRXCBErTx1HIGKgnp4i1uGwzIlCqDYg5CZkC9dLHRQgNKGmfgEBtSdvHQQgJKHUfeyEcoPR9rIVQgPrgYyuEAdQPn4hAfYmVEAJQTxoQsxNyB+qPj5WQM1CffGyEHIGiXhvNJsZCTkC94wkKFPfKetYxFbIF6qeOiKGQHVB/eZipkAVQT/tWGSMhY6C+64iYCBkC3QQeByD4Oqs3JAZCzXNWGeJ1VpOMvlDzfDHM66ymGW2h5hmHiNdZTTW6Qs1zVvGus5psTIEen57e83Gd1XSjKdQ8BqFdZzXl6Ak1z1llN/wwr6Il1DJndRBAWkJD+qX9fjSECAjIsIE0hAYOBAsNHQgUGjwQJERABASlW4iAACECYt1CBCTSIURAMu1CBCRDQFBahQgoT5sQAW3TIkRARZqFCKhMoxABlSEgKE1CBASEgIAQEBACAkJAQAgICAEBISAgOkAy1hdHCF8RZZUGQCq37d6AGBVRV0lAQEUCAioOewTWCAEBISAgBASEgICAQM1XrdPI9Qen+XwY8a3r159oVyyLG65Rfbv7kfkq5fd6W3YUAmq5ah0c8ZX96w/lvIbHj6DCtRTFDdco80ztmtEqnwnLth2FgFquGKWx1nvb7Xzx3Q8GW1spbrhGWWU7F8dglY/v/k9czahlRyGglmuOmWwub7Gnp/rvaFncYo35O2+4SsHRtqMQUMtV67QipjaIFfKOZvCWlsXN17gtbbpKDtS2ox5b0POH5+UDm3HIvAU9q47p+qt0aUHWYxA/ilU30AbIfAx6fF59YARkOwa1XLVOY6WFj3hbX/xXf3QvihuusTI2G65ScLTtqOZ50O5V6+DkJyWiIr9716CjqOLma9wOQearrJwH7a2WzqSBEBAQAgJCQEAICAgBAQkItDo+nPOb9dmty+K5v37eKXNntvfcZvr+VNZcHY86V7C+P8PZ0mqCAh3M5E0JJDz2iu0+txjxOmN+56Ii25glVMAiQYHeEbu5eMcMSLaLBW9Cq+MJsIbNFCphnqBA7z24ZJsvvuZAq+Msy8bi51iC8B+rk6+yw5/ufCOeuxB9aaE61EJ4rs9GTD65mWaZ6G9qAUxWmssHwsZDEwoK9P6XvB289suty/XZRLYKgVMAiRFG3PLHS26QN4fNVDQ7tjz4RpTbTEeSrFhAXomp9tXUIh0TFGiymLDlmL/Nf4s3OscogSbFc2L/VydiYJZ3mWw5AkrIiaeKBchKqmRZGDNhgZa8o0xkP1jyTnFQB6re8u6V97DtPksatlBfvRhXF8BH7yxThfPmhpmwQOsHf7w5X4oecjDba0G125P/5wPuDlA+yFQXoB7Lkan3QOzHr0diJFWNqKMFbabv5v2mDrQ8UCDVBbCyXO+7GO8iYwkk3n9+WiR2aH025h4HBZDayUW2PSm8UI1CAW2mXIbX3i5AVpIvbatjb3VgIHmI4vvIR42Db7nERTaSR+z37hdA8rnKSU9+6FZA8jAvWlG+ACWixiNW9kDEpPpZrHJk0v8A0fMTRaMsytF20f0JrJKef9QwSPXzmn676PuH1X6GgIAQEBACAkJAQAgICAEB+QcnImWPdGj0sQAAAABJRU5ErkJggg==" alt="Yield loadings on the spanned factors" />
<p class="caption">
Figure 3.1: Yield loadings on the spanned factors
</p>
</div>
<p>To directly obtain the time series of the country-specific spanned factors, the user can simply use the <em>Spanned_Factors</em> function as follows:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&#39;CM_Yields&#39;</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>Economies <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;China&quot;</span>, <span class="st">&quot;Brazil&quot;</span>, <span class="st">&quot;Mexico&quot;</span>, <span class="st">&quot;Uruguay&quot;</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>SpaFact <span class="ot">&lt;-</span> <span class="fu">Spanned_Factors</span>(Yields, Economies, N)</span></code></pre></div>
</div>
<div id="the-p-dynamics-estimation" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> The P-dynamics estimation</h2>
<p>As presented in Table <a href="#tab:ModFea">0.1</a>, the dynamics of the risk factors under the <span class="math inline">\(P\)</span>-measure evolve according to a VAR(1) model, which may be fully unrestricted (as in the case of the JPS-related models) or somewhat restricted (as in the GVAR and JLL frameworks). Below, the usage of each of these dimensions are illustrated.</p>
<div id="S:SectionVAR" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> VAR</h3>
<p>Using the <em>VAR</em> function of this package requires simply selecting the appropriated set of risk factors for the desired estimated model. For instance, for the models <em>JPS jointP</em> and <em>VAR jointQ</em>, the estimation of the <span class="math inline">\(P\)</span>-dynamics parameters is obtained as</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;CM_Factors&quot;</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>PdynPara <span class="ot">&lt;-</span> <span class="fu">VAR</span>(RiskFactors, <span class="at">VARtype=</span> <span class="st">&quot;unconstrained&quot;</span>)</span></code></pre></div>
<p>whereas the estimation of a <em>JPS</em> model for China is</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>FactorsChina <span class="ot">&lt;-</span> RiskFactors[<span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>,]</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>PdynPara <span class="ot">&lt;-</span> <span class="fu">VAR</span>(FactorsChina, <span class="at">VARtype=</span> <span class="st">&quot;unconstrained&quot;</span>)</span></code></pre></div>
<p>In both cases, the outputs generated are the vector of intercepts and both the feedback and variance-covariance matrices.</p>
</div>
<div id="S:SectionGVAR" class="section level3" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> GVAR</h3>
<p>The estimation of a GVAR model requires defining a measure of interdependence among the countries of the economic system. This information is reported in the transition matrix, the entries of which reflect the degree of interconnection of two entities of this same economic system. In this package, the illustration of the transition matrix is based on the average of the cross-border trade flow weights for the period spanning the years from 2006 to 2019. Note that each row sums up to 1.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;CM_Trade&quot;</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>t_First <span class="ot">&lt;-</span> <span class="st">&quot;2006&quot;</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>t_Last <span class="ot">&lt;-</span>  <span class="st">&quot;2019&quot;</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>Economies <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;China&quot;</span>, <span class="st">&quot;Brazil&quot;</span>, <span class="st">&quot;Mexico&quot;</span>, <span class="st">&quot;Uruguay&quot;</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>type <span class="ot">&lt;-</span> <span class="st">&quot;Sample Mean&quot;</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>W_gvar <span class="ot">&lt;-</span> <span class="fu">Transition_Matrix</span>(t_First, t_Last, Economies, type, <span class="at">DataPath =</span> <span class="cn">NULL</span>, TradeFlows)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(W_gvar)</span></code></pre></div>
<pre><code>##             China    Brazil     Mexico     Uruguay
## China   0.0000000 0.6549066 0.31550095 0.029592464
## Brazil  0.8268799 0.0000000 0.12340661 0.049713473
## Mexico  0.8596078 0.1326284 0.00000000 0.007763753
## Uruguay 0.3811195 0.5497525 0.06912795 0.000000000</code></pre>
<p>Having defined the form of the transition matrix, one can complete the <em>GVARinputs</em> variable along the lines discussed in Section <a href="#S:SectionGVARJLLinputs">2.1.1</a>.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;CM_Factors_GVAR&quot;</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>GVARinputs <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>GVARinputs<span class="sc">$</span>Economies <span class="ot">&lt;-</span> Economies</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>GVARinputs<span class="sc">$</span>GVARFactors <span class="ot">&lt;-</span> FactorsGVAR</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>GVARinputs<span class="sc">$</span>VARXtype <span class="ot">&lt;-</span> <span class="st">&quot;unconstrained&quot;</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>GVARinputs<span class="sc">$</span>Wgvar <span class="ot">&lt;-</span> W_gvar</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>GVARpara <span class="ot">&lt;-</span> <span class="fu">GVAR</span>(GVARinputs, N)</span></code></pre></div>
<p>A separate routine is provided for computing the foreign-specific factors (also commonly referred to as the star variables) used in the estimation of the VARX models.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&#39;CM_Factors&#39;</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>StaFac <span class="ot">&lt;-</span> <span class="fu">StarFactors</span>(RiskFactors, Economies, W_gvar)</span></code></pre></div>
</div>
<div id="S:SectionJLL" class="section level3" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> JLL</h3>
<p>Calculating the <span class="math inline">\(P\)</span>-dynamics parameters in the form proposed by JLL (2015) requires the following inputs: <em>(i)</em> the time series of the risk factors in non-orthogonalized form; <em>(ii)</em> the number of country-specific spanned factors and <em>(iii)</em> the specification of the <em>JLLinputs</em> as presented in Section <a href="#S:SectionGVARJLLinputs">2.1.1</a>. See, for instance:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;CM_Factors&quot;</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>JLLinputs <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>ModelType <span class="ot">&lt;-</span> <span class="st">&quot;JLL original&quot;</span>  </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>JLLinputs<span class="sc">$</span>Economies <span class="ot">&lt;-</span> Economies</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>JLLinputs<span class="sc">$</span>DomUnit <span class="ot">&lt;-</span> <span class="st">&quot;China&quot;</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>JLLinputs<span class="sc">$</span>WishSigmas <span class="ot">&lt;-</span> <span class="dv">1</span> </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>JLLinputs<span class="sc">$</span>SigmaNonOrtho <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>JLLinputs<span class="sc">$</span>JLLModelType <span class="ot">&lt;-</span> ModelType</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>JLLpara <span class="ot">&lt;-</span> <span class="fu">JLL</span>(RiskFactors, N, JLLinputs)</span></code></pre></div>
</div>
</div>
<div id="atsm-estimation" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> ATSM estimation</h2>
<p>The estimation of ATSM involves defining the model inputs from the log-likelihood function and, subsequently, the parameters used in its optimization process. The structure proposed in this part of the code is in a great extent based on the term structure package by <span class="citation">Le and Singleton (2018)</span>.</p>
<div id="the-log-likelihood-function" class="section level3" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> The log-likelihood function</h3>
<p>For the sake of simplicity, one illustrates the construction of a log-likelihood function based on a <em>VAR jointQ</em> model. For both the JLL and GVAR-based models, one must further specify the JLLinputs or GVARinputs along the lines described in the Section <a href="#S:SectionGVARJLLinputs">2.1.1</a>.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Inputs to be specified by the user</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;CM_Yields&quot;</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;CM_Factors&quot;</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>ModelType <span class="ot">&lt;-</span> <span class="st">&quot;VAR jointQ&quot;</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>Yields <span class="ot">&lt;-</span> Yields</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>ZZ <span class="ot">&lt;-</span> RiskFactors</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>Economies <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;China&quot;</span>, <span class="st">&quot;Brazil&quot;</span>, <span class="st">&quot;Mexico&quot;</span>, <span class="st">&quot;Uruguay&quot;</span>) </span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">&lt;-</span>  <span class="fu">Maturities</span>(Yields, Economies, <span class="at">UnitYields =</span> <span class="st">&quot;Month&quot;</span>)</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>DataFrequency <span class="ot">&lt;-</span> <span class="st">&quot;Monthly&quot;</span></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>GlobalVar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;GBC&quot;</span>, <span class="st">&quot;CPI_OECD&quot;</span>) <span class="co"># Global variables</span></span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>DomVar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Eco_Act&quot;</span>, <span class="st">&quot;Inflation&quot;</span>) <span class="co"># Domestic variables </span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># Number of country-specific spanned factors</span></span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate the &quot;Factor Labels&quot; list (necessary preliminarily step) </span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>FactorLabels <span class="ot">&lt;-</span> <span class="fu">LabFac</span>(N, DomVar, GlobalVar, Economies, ModelType) </span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare the inputs for log-Likelihood function</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>ATSMInputs <span class="ot">&lt;-</span> <span class="fu">InputsForMLEdensity</span>(ModelType, Yields, ZZ, FactorLabels, mat, Economies, DataFrequency)</span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Log-Likelihood function</span></span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">Functionf</span>(ATSMInputs, Economies, mat, DataFrequency, FactorLabels, ModelType)</span></code></pre></div>
</div>
<div id="optimization-parameters" class="section level3" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Optimization parameters</h3>
<p>JPS (2014) requires the estimation of a set of parameters containing 6 elements, namely: the risk-neutral
long-run mean of the short rate (<em>r0</em>), the risk-neutral feedback matrix (<em>K1XQ</em>), the variance-covariance matrix (<em>SSZ</em>) from the VAR processes, the standard deviation of the errors from the portfolios of yields observed with error (<em>se</em>), in addition to the intercept (<em>K0Z</em>) and the feedback (<em>K1Z</em>) matrices of the physical dynamics. Each of these parameters must be cast in an individual list that should contain the <em>(i)</em> the starting value of the parameter (if any); <em>(ii)</em> the variable label followed by a ‘:’ and a type of constraint; <em>(iii)</em> a lower bound (if any), and <em>(iv)</em> an upper bound (if any). The variable labels of <em>r0</em>, <em>se</em>, <em>K0Z</em> and <em>K1Z</em> should be preceded by the symbol @ as a manner to account for the fact that the solution of these parameters are known in closed-form. For the remaining ones (<em>K1XQ</em> and <em>SSZ</em>), <span class="citation">Le and Singleton (2018)</span> provide standardized routines (already incorporated in this package) to set good initial values so that the optimization process runs fast.</p>
<p>The type of constraint to be set for the parameters <em>r0</em>, <em>se</em>, <em>K0Z</em> and <em>K1Z</em> is typically <em>bounded</em> and are used for bounded matrices. For <em>K1XQ</em> and <em>SSZ</em>, the <em>MultiATSM</em> package currently provides the following options:</p>
<ul>
<li><strong>K1XQ:</strong> <em>‘Jordan’</em> (or <em>Jordan MultiCountry’</em>) for a matrix of Jordan type for single (multi) country specifications. These labels can be extended by <em>‘; stationary’</em>, if one wishes to impose the largest eigenvalue of the risk-neutral feedback matrix to be strictly smaller than 1;<br />
</li>
<li><strong>SSZ:</strong> <em>‘psd’</em> for a positive semi-definite matrix; <em>‘diag’</em> for a diagonal matrix; <em>‘BlockDiag’</em> for a block diagonal matrix (typical from the GVAR-based models) and <em>‘JLLstructure’</em> for the models containing the restrictions along the lines of JLL (2015).</li>
</ul>
<p>One example for the list of parameters specification is</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>K1XQinputs <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cn">NULL</span>, <span class="st">&quot;K1XQ: Jordan&quot;</span> , <span class="cn">NULL</span> , <span class="cn">NULL</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>SSZinputs <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cn">NULL</span>, <span class="st">&quot;SSZ: psd&quot;</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>r0inputs <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cn">NULL</span>, <span class="st">&quot;@r0: bounded&quot;</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>seinputs <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cn">NULL</span>, <span class="st">&quot;@se: bounded&quot;</span>, <span class="fl">1e-6</span>, <span class="cn">NULL</span>)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>K0Zinputs<span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cn">NULL</span>, <span class="st">&quot;@K0Z: bounded&quot;</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>K1Zinputs<span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cn">NULL</span>, <span class="st">&quot;@K1Z: bounded&quot;</span>, <span class="cn">NULL</span>, <span class="cn">NULL</span>)</span></code></pre></div>
<p>To complete the optimization setting, the user needs to specify the level of convergence tolerance (usually, 1e-4 is a reasonable value) and the vector <em>OptRun</em>. The first element of this vector must be filled by the word <em>‘iter off’</em>, if the user wishes to switch off the printouts of the numerical optimization routines, or simply by <em>‘iter’</em> otherwise. The second element of the vector concerns the algorithm that is used in the optimization: the option <em>‘fminunc only’</em> only uses fminunc, whereas <em>‘fminsearch only’</em> only applies fminsearch. If <em>OptRun</em> is formed exclusively by <em>‘iter off’</em>, then both fminunc and fminsearch are employed in the optimization.</p>
</div>
</div>
</div>
<div id="S:SectionReplication" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Examples of full implementation of ATSMs</h1>
<p>This section presents some examples on how to use the <em>MultiATSM</em> package to fully implement ATSMs. Further on, the functions of this package are used to replicate some of the results presented in the original papers of JPS (2014) and CM (2021).</p>
<div id="general-template" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> General template</h2>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="do">########################################################################################################</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="do">#################################### USER INPUTS #######################################################</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="do">########################################################################################################</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># A) Load database data</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;CM_Factors&quot;</span>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&#39;CM_Factors_GVAR&#39;</span>)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&#39;CM_Trade&#39;</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&#39;CM_Yields&#39;</span>)</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="co"># B) Decide on general model inputs</span></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>ModelType <span class="ot">&lt;-</span> <span class="st">&quot;VAR jointQ&quot;</span> <span class="co"># available options are &quot;JPS&quot;, &quot;JPS jointP&quot;, &quot;GVAR sepQ&quot;, &quot;VAR jointQ&quot;, </span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>                          <span class="co">#&quot;GVAR jointQ&quot;, &quot;JLL original&quot;, &quot;JLL NoDomUnit&quot;, &quot;JLL jointSigma&quot;.</span></span>
<span id="cb29-13"><a href="#cb29-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-14"><a href="#cb29-14" aria-hidden="true" tabindex="-1"></a>StationarityUnderQ <span class="ot">&lt;-</span> <span class="dv">0</span> <span class="co"># Wish to impose stationary condition for the eigenvalues of each country: </span></span>
<span id="cb29-15"><a href="#cb29-15" aria-hidden="true" tabindex="-1"></a>                         <span class="co">#YES: 1,NO:0</span></span>
<span id="cb29-16"><a href="#cb29-16" aria-hidden="true" tabindex="-1"></a>BiasCorrection <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># Wish to estimate the model with the bias correction method of BRW (2012): </span></span>
<span id="cb29-17"><a href="#cb29-17" aria-hidden="true" tabindex="-1"></a>                    <span class="co">#YES: 1, NO:0</span></span>
<span id="cb29-18"><a href="#cb29-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-19"><a href="#cb29-19" aria-hidden="true" tabindex="-1"></a>WishForwardPremia <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># Wish to estimate the forward premia: YES: 1, NO:0</span></span>
<span id="cb29-20"><a href="#cb29-20" aria-hidden="true" tabindex="-1"></a>FPmatLim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">60</span>,<span class="dv">120</span>) <span class="co">#  If the forward premia is desired, then choose the Min and max maturities of the    </span></span>
<span id="cb29-21"><a href="#cb29-21" aria-hidden="true" tabindex="-1"></a>                        <span class="co"># forward premia. Otherwise set NA</span></span>
<span id="cb29-22"><a href="#cb29-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-23"><a href="#cb29-23" aria-hidden="true" tabindex="-1"></a>Economies <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;China&quot;</span>, <span class="st">&quot;Brazil&quot;</span>, <span class="st">&quot;Mexico&quot;</span>, <span class="st">&quot;Uruguay&quot;</span>) <span class="co"># Names of the economies from the economic system</span></span>
<span id="cb29-24"><a href="#cb29-24" aria-hidden="true" tabindex="-1"></a>GlobalVar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;GBC&quot;</span>, <span class="st">&quot;CPI_OECD&quot;</span>) <span class="co"># Global Variables</span></span>
<span id="cb29-25"><a href="#cb29-25" aria-hidden="true" tabindex="-1"></a>DomVar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Eco_Act&quot;</span>, <span class="st">&quot;Inflation&quot;</span>) <span class="co"># Country-specific variables</span></span>
<span id="cb29-26"><a href="#cb29-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-27"><a href="#cb29-27" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># Number of spanned factors per country</span></span>
<span id="cb29-28"><a href="#cb29-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-29"><a href="#cb29-29" aria-hidden="true" tabindex="-1"></a>OutputLabel <span class="ot">&lt;-</span> <span class="st">&quot;Test&quot;</span> <span class="co"># label of the model for saving the file</span></span>
<span id="cb29-30"><a href="#cb29-30" aria-hidden="true" tabindex="-1"></a>DataFrequency <span class="ot">&lt;-</span> <span class="st">&quot;Monthly&quot;</span> <span class="co"># Frequency of the data</span></span>
<span id="cb29-31"><a href="#cb29-31" aria-hidden="true" tabindex="-1"></a>UnitMatYields <span class="ot">&lt;-</span> <span class="st">&quot;Month&quot;</span> <span class="co"># bond yields time-unit. Available options are &quot;Month&quot; or &quot;Year&quot;</span></span>
<span id="cb29-32"><a href="#cb29-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-33"><a href="#cb29-33" aria-hidden="true" tabindex="-1"></a><span class="co"># B.1) Decide on specific model inputs</span></span>
<span id="cb29-34"><a href="#cb29-34" aria-hidden="true" tabindex="-1"></a><span class="do">#################################### GVAR-based models ##################################################</span></span>
<span id="cb29-35"><a href="#cb29-35" aria-hidden="true" tabindex="-1"></a>t_First_Wgvar <span class="ot">&lt;-</span> <span class="st">&quot;2004&quot;</span> <span class="co"># First year of the sample (transition matrix)</span></span>
<span id="cb29-36"><a href="#cb29-36" aria-hidden="true" tabindex="-1"></a>t_Last_Wgvar <span class="ot">&lt;-</span>  <span class="st">&quot;2019&quot;</span> <span class="co"># Last year of the sample (transition matrix)</span></span>
<span id="cb29-37"><a href="#cb29-37" aria-hidden="true" tabindex="-1"></a>W_type <span class="ot">&lt;-</span> <span class="st">&#39;Sample Mean&#39;</span> <span class="co"># Method to compute the transition matrix</span></span>
<span id="cb29-38"><a href="#cb29-38" aria-hidden="true" tabindex="-1"></a>VARXtype <span class="ot">&lt;-</span> <span class="st">&quot;unconstrained&quot;</span> <span class="co"># (i) &quot;unconstrained&quot; or (ii) &quot;&quot;constrained&quot; (VARX)</span></span>
<span id="cb29-39"><a href="#cb29-39" aria-hidden="true" tabindex="-1"></a><span class="do">#################################### JLL-based models ###################################################</span></span>
<span id="cb29-40"><a href="#cb29-40" aria-hidden="true" tabindex="-1"></a>DomUnit <span class="ot">&lt;-</span> <span class="st">&quot;China&quot;</span></span>
<span id="cb29-41"><a href="#cb29-41" aria-hidden="true" tabindex="-1"></a>WishSigmas <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># Sigma matrix is estimated within the &quot;InputsForMLEdensity&quot; function</span></span>
<span id="cb29-42"><a href="#cb29-42" aria-hidden="true" tabindex="-1"></a>SigmaNonOrtho <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb29-43"><a href="#cb29-43" aria-hidden="true" tabindex="-1"></a>JLLModelType <span class="ot">&lt;-</span> ModelType</span>
<span id="cb29-44"><a href="#cb29-44" aria-hidden="true" tabindex="-1"></a><span class="do">###################################### BRW inputs  ######################################################</span></span>
<span id="cb29-45"><a href="#cb29-45" aria-hidden="true" tabindex="-1"></a>flag_mean <span class="ot">&lt;-</span> <span class="cn">TRUE</span> <span class="co"># TRUE = compute the mean; FALSE = compute the median</span></span>
<span id="cb29-46"><a href="#cb29-46" aria-hidden="true" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="fl">0.2</span> <span class="co"># Adjustment parameter</span></span>
<span id="cb29-47"><a href="#cb29-47" aria-hidden="true" tabindex="-1"></a>N_iter <span class="ot">&lt;-</span> <span class="dv">500</span> <span class="co"># Number of iteration to be conserved </span></span>
<span id="cb29-48"><a href="#cb29-48" aria-hidden="true" tabindex="-1"></a>N_burn <span class="ot">&lt;-</span> N_iter<span class="sc">*</span><span class="fl">0.15</span>  <span class="co"># Number of iteration to be discarded </span></span>
<span id="cb29-49"><a href="#cb29-49" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">50</span> <span class="co"># Number of bootstrap samples </span></span>
<span id="cb29-50"><a href="#cb29-50" aria-hidden="true" tabindex="-1"></a>checkBRW <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb29-51"><a href="#cb29-51" aria-hidden="true" tabindex="-1"></a>B_check <span class="ot">&lt;-</span> <span class="dv">1000</span> <span class="co"># </span></span>
<span id="cb29-52"><a href="#cb29-52" aria-hidden="true" tabindex="-1"></a><span class="do">#########################################################################################################</span></span>
<span id="cb29-53"><a href="#cb29-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-54"><a href="#cb29-54" aria-hidden="true" tabindex="-1"></a><span class="co"># C) Decide on Settings for numerical outputs</span></span>
<span id="cb29-55"><a href="#cb29-55" aria-hidden="true" tabindex="-1"></a>Horiz <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb29-56"><a href="#cb29-56" aria-hidden="true" tabindex="-1"></a>DesiredGraphs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Fit&quot;</span>, <span class="st">&quot;IRF&quot;</span>, <span class="st">&quot;FEVD&quot;</span>) <span class="co"># &quot;Fit&quot;, &quot;IRF&quot;, &quot;FEVD&quot;, &quot;GIRF&quot;, &quot;GFEVD&quot;, &quot;TermPremia&quot;</span></span>
<span id="cb29-57"><a href="#cb29-57" aria-hidden="true" tabindex="-1"></a>WishGraphRiskFac <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb29-58"><a href="#cb29-58" aria-hidden="true" tabindex="-1"></a>WishGraphYields <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb29-59"><a href="#cb29-59" aria-hidden="true" tabindex="-1"></a>WishOrthoJLLgraphs <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb29-60"><a href="#cb29-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-61"><a href="#cb29-61" aria-hidden="true" tabindex="-1"></a><span class="co"># D) Bootstrao settings</span></span>
<span id="cb29-62"><a href="#cb29-62" aria-hidden="true" tabindex="-1"></a>WishBootstrap <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co">#  YES: 1; No = 0.</span></span>
<span id="cb29-63"><a href="#cb29-63" aria-hidden="true" tabindex="-1"></a>Bootlist <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb29-64"><a href="#cb29-64" aria-hidden="true" tabindex="-1"></a>Bootlist<span class="sc">$</span>methodBS <span class="ot">&lt;-</span> <span class="st">&#39;bs&#39;</span> <span class="co"># (i) &#39;bs&#39; ; (ii) &#39;wild&#39;; (iii) &#39;block&#39;</span></span>
<span id="cb29-65"><a href="#cb29-65" aria-hidden="true" tabindex="-1"></a>Bootlist<span class="sc">$</span>BlockLength <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="co"># necessary input if one chooses the block bootstrap</span></span>
<span id="cb29-66"><a href="#cb29-66" aria-hidden="true" tabindex="-1"></a>Bootlist<span class="sc">$</span>ndraws <span class="ot">&lt;-</span>  <span class="dv">5</span></span>
<span id="cb29-67"><a href="#cb29-67" aria-hidden="true" tabindex="-1"></a>Bootlist<span class="sc">$</span>pctg   <span class="ot">&lt;-</span>  <span class="dv">95</span> <span class="co"># confidence level</span></span>
<span id="cb29-68"><a href="#cb29-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-69"><a href="#cb29-69" aria-hidden="true" tabindex="-1"></a><span class="co"># E) Out-of-sample forecast</span></span>
<span id="cb29-70"><a href="#cb29-70" aria-hidden="true" tabindex="-1"></a>WishForecast <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co">#  YES: 1; No = 0.</span></span>
<span id="cb29-71"><a href="#cb29-71" aria-hidden="true" tabindex="-1"></a>ForecastList <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb29-72"><a href="#cb29-72" aria-hidden="true" tabindex="-1"></a>ForecastList<span class="sc">$</span>ForHoriz <span class="ot">&lt;-</span> <span class="dv">12</span> <span class="co"># forecast horizon</span></span>
<span id="cb29-73"><a href="#cb29-73" aria-hidden="true" tabindex="-1"></a>ForecastList<span class="sc">$</span>t0Sample <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="co"># initial sample date</span></span>
<span id="cb29-74"><a href="#cb29-74" aria-hidden="true" tabindex="-1"></a>ForecastList<span class="sc">$</span>t0Forecast <span class="ot">&lt;-</span> <span class="dv">145</span> <span class="co"># last sample date for the first forecast</span></span>
<span id="cb29-75"><a href="#cb29-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-76"><a href="#cb29-76" aria-hidden="true" tabindex="-1"></a><span class="do">#########################################################################################################</span></span>
<span id="cb29-77"><a href="#cb29-77" aria-hidden="true" tabindex="-1"></a><span class="do">############################### NO NEED TO MAKE CHANGES FROM HERE #######################################</span></span>
<span id="cb29-78"><a href="#cb29-78" aria-hidden="true" tabindex="-1"></a><span class="do">#########################################################################################################</span></span>
<span id="cb29-79"><a href="#cb29-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-80"><a href="#cb29-80" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Minor preliminary work</span></span>
<span id="cb29-81"><a href="#cb29-81" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">length</span>(Economies)</span>
<span id="cb29-82"><a href="#cb29-82" aria-hidden="true" tabindex="-1"></a>FactorLabels <span class="ot">&lt;-</span> <span class="fu">LabFac</span>(N, DomVar,GlobalVar, Economies, ModelType) <span class="co"># Generate the set of labels</span></span>
<span id="cb29-83"><a href="#cb29-83" aria-hidden="true" tabindex="-1"></a>ZZ <span class="ot">&lt;-</span> RiskFactors</span>
<span id="cb29-84"><a href="#cb29-84" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">any</span>(ModelType <span class="sc">==</span> <span class="fu">c</span>(<span class="st">&quot;GVAR sepQ&quot;</span>, <span class="st">&quot;GVAR jointQ&quot;</span>))){</span>
<span id="cb29-85"><a href="#cb29-85" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb29-86"><a href="#cb29-86" aria-hidden="true" tabindex="-1"></a>Data<span class="sc">$</span>GVARFactors <span class="ot">&lt;-</span> FactorsGVAR}</span>
<span id="cb29-87"><a href="#cb29-87" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">&lt;-</span> <span class="fu">Maturities</span>(Yields, Economies, <span class="at">UnitYields =</span> UnitMatYields)</span>
<span id="cb29-88"><a href="#cb29-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-89"><a href="#cb29-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-90"><a href="#cb29-90" aria-hidden="true" tabindex="-1"></a><span class="co"># 2.1) Generate GVARinputs, JLLinputs and BRWinputs</span></span>
<span id="cb29-91"><a href="#cb29-91" aria-hidden="true" tabindex="-1"></a>ModInputs <span class="ot">&lt;-</span> <span class="fu">ListModelInputs</span>(ModelType, Data, Economies, VARXtype, t_First_Wgvar, t_Last_Wgvar, W_type,</span>
<span id="cb29-92"><a href="#cb29-92" aria-hidden="true" tabindex="-1"></a>                             DomUnit, WishSigmas, SigmaNonOrtho, BiasCorrection, flag_mean, gamma, N_iter,</span>
<span id="cb29-93"><a href="#cb29-93" aria-hidden="true" tabindex="-1"></a>                             N_burn, B, checkBRW, B_check)</span>
<span id="cb29-94"><a href="#cb29-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-95"><a href="#cb29-95" aria-hidden="true" tabindex="-1"></a>GVARinputs <span class="ot">&lt;-</span> ModInputs<span class="sc">$</span>GVARinputs</span>
<span id="cb29-96"><a href="#cb29-96" aria-hidden="true" tabindex="-1"></a>JLLinputs <span class="ot">&lt;-</span> ModInputs<span class="sc">$</span>JLLinputs</span>
<span id="cb29-97"><a href="#cb29-97" aria-hidden="true" tabindex="-1"></a>BRWinputs <span class="ot">&lt;-</span> ModInputs<span class="sc">$</span>BRWinputs</span>
<span id="cb29-98"><a href="#cb29-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-99"><a href="#cb29-99" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Prepare the inputs of the likelihood function</span></span>
<span id="cb29-100"><a href="#cb29-100" aria-hidden="true" tabindex="-1"></a>ModelParaList <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb29-101"><a href="#cb29-101" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>C){</span>
<span id="cb29-102"><a href="#cb29-102" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (( <span class="fu">any</span>(ModelType <span class="sc">==</span><span class="fu">c</span>(<span class="st">&quot;GVAR jointQ&quot;</span>, <span class="st">&quot;VAR jointQ&quot;</span>,<span class="st">&quot;JLL original&quot;</span>, <span class="st">&quot;JLL NoDomUnit&quot;</span>,<span class="st">&quot;JLL jointSigma&quot;</span>))) </span>
<span id="cb29-103"><a href="#cb29-103" aria-hidden="true" tabindex="-1"></a>      <span class="sc">&amp;</span> i <span class="sc">&gt;</span><span class="dv">1</span> ){<span class="cf">break</span>} </span>
<span id="cb29-104"><a href="#cb29-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-105"><a href="#cb29-105" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3.1) Compute the inputs that go directly into the log-likelihood function</span></span>
<span id="cb29-106"><a href="#cb29-106" aria-hidden="true" tabindex="-1"></a>  ATSMInputs <span class="ot">&lt;-</span> <span class="fu">InputsForMLEdensity</span>(ModelType, Yields, ZZ, FactorLabels, mat, Economies, DataFrequency,</span>
<span id="cb29-107"><a href="#cb29-107" aria-hidden="true" tabindex="-1"></a>                                    JLLinputs, GVARinputs, BRWinputs)</span>
<span id="cb29-108"><a href="#cb29-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-109"><a href="#cb29-109" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3.2) Initial guesses for Variables that will be concentrared out of from the log-likelihood function</span></span>
<span id="cb29-110"><a href="#cb29-110" aria-hidden="true" tabindex="-1"></a>  K1XQ <span class="ot">&lt;-</span> ATSMInputs<span class="sc">$</span>K1XQ</span>
<span id="cb29-111"><a href="#cb29-111" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(ModelType <span class="sc">==</span> <span class="fu">c</span>(<span class="st">&quot;JLL original&quot;</span>, <span class="st">&quot;JLL NoDomUnit&quot;</span>))){ SSZ <span class="ot">&lt;-</span> <span class="cn">NULL</span>} <span class="cf">else</span>{SSZ <span class="ot">&lt;-</span> ATSMInputs<span class="sc">$</span>SSZ}</span>
<span id="cb29-112"><a href="#cb29-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-113"><a href="#cb29-113" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 4) Build the objective function</span></span>
<span id="cb29-114"><a href="#cb29-114" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="fu">Functionf</span>(ATSMInputs, Economies, mat, DataFrequency, FactorLabels, ModelType)</span>
<span id="cb29-115"><a href="#cb29-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-116"><a href="#cb29-116" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 5) Set the optimization settings</span></span>
<span id="cb29-117"><a href="#cb29-117" aria-hidden="true" tabindex="-1"></a>  VarLab <span class="ot">&lt;-</span> <span class="fu">ParaLabels</span>(ModelType, StationarityUnderQ)</span>
<span id="cb29-118"><a href="#cb29-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-119"><a href="#cb29-119" aria-hidden="true" tabindex="-1"></a>  varargin <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb29-120"><a href="#cb29-120" aria-hidden="true" tabindex="-1"></a>  varargin<span class="sc">$</span>K1XQ <span class="ot">&lt;-</span><span class="fu">list</span>(K1XQ, VarLab[[ModelType]][[<span class="st">&quot;K1XQ&quot;</span>]] , <span class="cn">NULL</span> , <span class="cn">NULL</span>)</span>
<span id="cb29-121"><a href="#cb29-121" aria-hidden="true" tabindex="-1"></a>  varargin<span class="sc">$</span>SSZ <span class="ot">&lt;-</span> <span class="fu">list</span>(SSZ, VarLab[[ModelType]][[<span class="st">&quot;SSZ&quot;</span>]], <span class="cn">NULL</span>, <span class="cn">NULL</span>)</span>
<span id="cb29-122"><a href="#cb29-122" aria-hidden="true" tabindex="-1"></a>  varargin<span class="sc">$</span>r0 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cn">NULL</span>, VarLab[[ModelType]][[<span class="st">&quot;r0&quot;</span>]], <span class="cn">NULL</span>, <span class="cn">NULL</span>)</span>
<span id="cb29-123"><a href="#cb29-123" aria-hidden="true" tabindex="-1"></a>  varargin<span class="sc">$</span>se <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cn">NULL</span>, VarLab[[ModelType]][[<span class="st">&quot;se&quot;</span>]], <span class="fl">1e-6</span>, <span class="cn">NULL</span>)</span>
<span id="cb29-124"><a href="#cb29-124" aria-hidden="true" tabindex="-1"></a>  varargin<span class="sc">$</span>K0Z <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cn">NULL</span>, VarLab[[ModelType]][[<span class="st">&quot;K0Z&quot;</span>]], <span class="cn">NULL</span>, <span class="cn">NULL</span>)</span>
<span id="cb29-125"><a href="#cb29-125" aria-hidden="true" tabindex="-1"></a>  varargin<span class="sc">$</span>K1Z <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cn">NULL</span>, VarLab[[ModelType]][[<span class="st">&quot;K1Z&quot;</span>]], <span class="cn">NULL</span>, <span class="cn">NULL</span>)</span>
<span id="cb29-126"><a href="#cb29-126" aria-hidden="true" tabindex="-1"></a>  varargin<span class="sc">$</span>OptRun <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;iter off&quot;</span>)</span>
<span id="cb29-127"><a href="#cb29-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-128"><a href="#cb29-128" aria-hidden="true" tabindex="-1"></a>  LabelVar<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Value&#39;</span>, <span class="st">&#39;Label&#39;</span>, <span class="st">&#39;LB&#39;</span>, <span class="st">&#39;UB&#39;</span>) <span class="co"># Elements of each parameter</span></span>
<span id="cb29-129"><a href="#cb29-129" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (d <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(varargin)<span class="sc">-</span><span class="dv">1</span>)){ <span class="fu">names</span>(varargin[[d]]) <span class="ot">&lt;-</span>  LabelVar}</span>
<span id="cb29-130"><a href="#cb29-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-131"><a href="#cb29-131" aria-hidden="true" tabindex="-1"></a>  tol <span class="ot">&lt;-</span> <span class="fl">1e-4</span></span>
<span id="cb29-132"><a href="#cb29-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-133"><a href="#cb29-133" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 6) Optimization of the model</span></span>
<span id="cb29-134"><a href="#cb29-134" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (ModelType <span class="sc">==</span> <span class="st">&#39;JPS&#39;</span> <span class="sc">||</span> ModelType <span class="sc">==</span> <span class="st">&#39;JPS jointP&#39;</span> <span class="sc">||</span> ModelType <span class="sc">==</span> <span class="st">&quot;GVAR sepQ&quot;</span>){</span>
<span id="cb29-135"><a href="#cb29-135" aria-hidden="true" tabindex="-1"></a>ModelParaList[[ModelType]][[Economies[i]]] <span class="ot">&lt;-</span> <span class="fu">Optimization</span>(f, tol, varargin, FactorLabels,</span>
<span id="cb29-136"><a href="#cb29-136" aria-hidden="true" tabindex="-1"></a>                                                           Economies, ModelType)<span class="sc">$</span>Summary</span>
<span id="cb29-137"><a href="#cb29-137" aria-hidden="true" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb29-138"><a href="#cb29-138" aria-hidden="true" tabindex="-1"></a>ModelParaList[[ModelType]] <span class="ot">&lt;-</span> <span class="fu">Optimization</span>(f, tol, varargin, FactorLabels, Economies, ModelType,</span>
<span id="cb29-139"><a href="#cb29-139" aria-hidden="true" tabindex="-1"></a>                                           JLLinputs, GVARinputs)<span class="sc">$</span>Summary}</span>
<span id="cb29-140"><a href="#cb29-140" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb29-141"><a href="#cb29-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-142"><a href="#cb29-142" aria-hidden="true" tabindex="-1"></a><span class="co"># 7) Numerical and graphical outputs</span></span>
<span id="cb29-143"><a href="#cb29-143" aria-hidden="true" tabindex="-1"></a>InputsForOutputs <span class="ot">&lt;-</span> <span class="fu">InputsForOutputs</span>(ModelType, Horiz, DesiredGraphs, OutputLabel, StationarityUnderQ,</span>
<span id="cb29-144"><a href="#cb29-144" aria-hidden="true" tabindex="-1"></a>                                     UnitMatYields, WishGraphYields, WishGraphRiskFac, WishOrthoJLLgraphs,</span>
<span id="cb29-145"><a href="#cb29-145" aria-hidden="true" tabindex="-1"></a>                                     WishForwardPremia, FPmatLim, WishBootstrap, Bootlist, WishForecast,</span>
<span id="cb29-146"><a href="#cb29-146" aria-hidden="true" tabindex="-1"></a>                                     ForecastList)</span>
<span id="cb29-147"><a href="#cb29-147" aria-hidden="true" tabindex="-1"></a><span class="co"># A) Fit, IRF, FEVD, GIRF, GFEVD, and Term Premia</span></span>
<span id="cb29-148"><a href="#cb29-148" aria-hidden="true" tabindex="-1"></a>NumericalOutputs <span class="ot">&lt;-</span> <span class="fu">NumOutputs</span>(ModelType, ModelParaList, InputsForOutputs, FactorLabels, Economies)</span>
<span id="cb29-149"><a href="#cb29-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-150"><a href="#cb29-150" aria-hidden="true" tabindex="-1"></a><span class="co"># B) Bootstrap</span></span>
<span id="cb29-151"><a href="#cb29-151" aria-hidden="true" tabindex="-1"></a>Bootstrap <span class="ot">&lt;-</span> <span class="fu">Bootstrap</span>(ModelType, ModelParaList, NumericalOutputs, mat, Economies, InputsForOutputs,</span>
<span id="cb29-152"><a href="#cb29-152" aria-hidden="true" tabindex="-1"></a>                       FactorLabels, DataFrequency, varargin, JLLinputs, GVARinputs, BRWinputs)</span>
<span id="cb29-153"><a href="#cb29-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-154"><a href="#cb29-154" aria-hidden="true" tabindex="-1"></a><span class="co"># C) Out-of-sample forecasting</span></span>
<span id="cb29-155"><a href="#cb29-155" aria-hidden="true" tabindex="-1"></a>Forecasts <span class="ot">&lt;-</span> <span class="fu">ForecastYields</span>(ModelType, ModelParaList, InputsForOutputs, FactorLabels, Economies,</span>
<span id="cb29-156"><a href="#cb29-156" aria-hidden="true" tabindex="-1"></a>                            DataFrequency, JLLinputs, GVARinputs, BRWinputs)</span></code></pre></div>
</div>
<div id="paper-replications" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Paper replications</h2>
<div id="joslin-priebisch-and-singleton-2014" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> Joslin, Priebisch and Singleton (2014)</h3>
<p>To the best of my knowledge, the original data-set used in <span class="citation">Joslin, Priebsch, and Singleton (2014)</span> is not publicly available. Nevertheless, there exists an alternative source of data that closely matches JPS (2014) in terms of the construction method and the sample period. This database is constructed by <span class="citation">Bauer and Rudebusch (2017)</span> (BR, 2017) and is available at <a href="https://www.michaeldbauer.com/publication/spanning-puzzle/">Bauer’s website</a>. In that paper, BR (2017) investigate whether macro-finance term structure models better suit the unspanned macro risk framework by JPS (2014) or the earlier traditional spanned settings as the one by <span class="citation">Ang and Piazzesi (2003)</span>. Accordingly, BR (2017) intend to replicate some of the empirical results reported in JPS (2014). The R-code used by BR (2017) is also available at <a href="https://www.michaeldbauer.com/publication/spanning-puzzle/">Bauer’s website</a>.</p>
<p>Supported by BR (2017)’s data-set, the code below uses the <em>MultiATSM</em> package to estimate the key model parameters from the ATSM along the lines of JPS (2014).</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="do">#########################################################################################################</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="do">#################################### USER INPUTS ########################################################</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="do">#########################################################################################################</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="co"># A) Load database data</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;BR_jps_gro_R3&quot;</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># B) Decide on general model inputs</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>ModelType <span class="ot">&lt;-</span> <span class="st">&quot;JPS&quot;</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>StationarityUnderQ <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>BiasCorrection <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>WishForwardPremia <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>Economies <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;U.S.&quot;</span>) <span class="co"># Names of the economies from the economic system</span></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>GlobalVar <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>DomVar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;GRO&quot;</span>, <span class="st">&quot;INF&quot;</span>) <span class="co"># Country-specific variables</span></span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># Number of spanned factors per country</span></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>DataFrequency <span class="ot">&lt;-</span> <span class="st">&quot;Monthly&quot;</span> <span class="co"># Frequency of the data</span></span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>UnitMatYields <span class="ot">&lt;-</span> <span class="st">&quot;Month&quot;</span> <span class="co"># time-unit in which yields are expressed. Available options are &quot;Month&quot; or &quot;Year&quot;</span></span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">8</span>, <span class="dv">9</span>, <span class="dv">10</span>) <span class="co"># maturities expressed in years</span></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a><span class="do">#########################################################################################################</span></span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a><span class="do">############################### NO NEED TO MAKE CHANGES FROM HERE #######################################</span></span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a><span class="do">#########################################################################################################</span></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Minor preliminary work</span></span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">length</span>(Economies)</span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">length</span>(DomVar)</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a>FactorLabels <span class="ot">&lt;-</span> <span class="fu">LabFac</span>(N, DomVar, GlobalVar, Economies, ModelType) <span class="co"># Generate the set of labels</span></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>Yields <span class="ot">&lt;-</span> <span class="fu">t</span>(BR_jps_out<span class="sc">$</span>Y)</span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>W <span class="ot">&lt;-</span> BR_jps_out<span class="sc">$</span>W[<span class="dv">1</span><span class="sc">:</span>N,] <span class="co"># Use the Wpca matrix from BR (2017)</span></span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>SpaFac <span class="ot">&lt;-</span> W<span class="sc">%*%</span>Yields</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(SpaFac) <span class="ot">&lt;-</span> FactorLabels<span class="sc">$</span>Tables<span class="sc">$</span>U.S.[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>M)]</span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>ZZ <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">t</span>(BR_jps_out<span class="sc">$</span>M.o), SpaFac) <span class="co"># Complete set of risk factors</span></span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Prepare the inputs of the likelihood function</span></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="fu">length</span>(Economies)</span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3.1) Compute the inputs that go directly into the log-likelihood function</span></span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a>  ATSMInputs <span class="ot">&lt;-</span> <span class="fu">InputsForMLEdensity</span>(ModelType, Yields, ZZ, FactorLabels, mat, Economies, DataFrequency)</span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3.2) Initial guesses for Variables that will be concentrared out of from the log-likelihood function</span></span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>  K1XQ <span class="ot">&lt;-</span> ATSMInputs<span class="sc">$</span>K1XQ</span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a>  SSZ <span class="ot">&lt;-</span> ATSMInputs<span class="sc">$</span>SSZ</span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 3.3) Adjust the inputs which are funtion of the W matrix</span></span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a>  ATSMInputs<span class="sc">$</span>Wpca <span class="ot">&lt;-</span> W</span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a>  ATSMInputs<span class="sc">$</span>We <span class="ot">&lt;-</span> <span class="fu">t</span>(pracma<span class="sc">::</span><span class="fu">null</span>(W))</span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a>  ATSMInputs<span class="sc">$</span>WpcaFull <span class="ot">&lt;-</span> <span class="fu">rbind</span>(ATSMInputs<span class="sc">$</span>Wpca, ATSMInputs<span class="sc">$</span>We)</span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a>  ATSMInputs<span class="sc">$</span>PP <span class="ot">&lt;-</span> SpaFac</span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 4) Build the objective function</span></span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="fu">Functionf</span>(ATSMInputs, Economies, mat, DataFrequency, FactorLabels, ModelType)</span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-56"><a href="#cb30-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 5) Set the optimization settings</span></span>
<span id="cb30-57"><a href="#cb30-57" aria-hidden="true" tabindex="-1"></a>  VarLab <span class="ot">&lt;-</span> <span class="fu">ParaLabels</span>(ModelType, StationarityUnderQ)</span>
<span id="cb30-58"><a href="#cb30-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-59"><a href="#cb30-59" aria-hidden="true" tabindex="-1"></a>  varargin <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb30-60"><a href="#cb30-60" aria-hidden="true" tabindex="-1"></a>  varargin<span class="sc">$</span>K1XQ <span class="ot">&lt;-</span><span class="fu">list</span>(K1XQ, VarLab[[ModelType]][[<span class="st">&quot;K1XQ&quot;</span>]] , <span class="cn">NULL</span> , <span class="cn">NULL</span>)</span>
<span id="cb30-61"><a href="#cb30-61" aria-hidden="true" tabindex="-1"></a>  varargin<span class="sc">$</span>SSZ <span class="ot">&lt;-</span> <span class="fu">list</span>(SSZ, VarLab[[ModelType]][[<span class="st">&quot;SSZ&quot;</span>]], <span class="cn">NULL</span>, <span class="cn">NULL</span>)</span>
<span id="cb30-62"><a href="#cb30-62" aria-hidden="true" tabindex="-1"></a>  varargin<span class="sc">$</span>r0 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cn">NULL</span>, VarLab[[ModelType]][[<span class="st">&quot;r0&quot;</span>]], <span class="cn">NULL</span>, <span class="cn">NULL</span>)</span>
<span id="cb30-63"><a href="#cb30-63" aria-hidden="true" tabindex="-1"></a>  varargin<span class="sc">$</span>se <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cn">NULL</span>, VarLab[[ModelType]][[<span class="st">&quot;se&quot;</span>]], <span class="fl">1e-6</span>, <span class="cn">NULL</span>)</span>
<span id="cb30-64"><a href="#cb30-64" aria-hidden="true" tabindex="-1"></a>  varargin<span class="sc">$</span>K0Z <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cn">NULL</span>, VarLab[[ModelType]][[<span class="st">&quot;K0Z&quot;</span>]], <span class="cn">NULL</span>, <span class="cn">NULL</span>)</span>
<span id="cb30-65"><a href="#cb30-65" aria-hidden="true" tabindex="-1"></a>  varargin<span class="sc">$</span>K1Z <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cn">NULL</span>, VarLab[[ModelType]][[<span class="st">&quot;K1Z&quot;</span>]], <span class="cn">NULL</span>, <span class="cn">NULL</span>)</span>
<span id="cb30-66"><a href="#cb30-66" aria-hidden="true" tabindex="-1"></a>  varargin<span class="sc">$</span>OptRun <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="st">&quot;iter off&quot;</span>)</span>
<span id="cb30-67"><a href="#cb30-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-68"><a href="#cb30-68" aria-hidden="true" tabindex="-1"></a>  LabelVar<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Value&#39;</span>, <span class="st">&#39;Label&#39;</span>, <span class="st">&#39;LB&#39;</span>, <span class="st">&#39;UB&#39;</span>) <span class="co"># Elements of each parameter</span></span>
<span id="cb30-69"><a href="#cb30-69" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (d <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(varargin)<span class="sc">-</span><span class="dv">1</span>)){ <span class="fu">names</span>(varargin[[d]]) <span class="ot">&lt;-</span>  LabelVar}</span>
<span id="cb30-70"><a href="#cb30-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-71"><a href="#cb30-71" aria-hidden="true" tabindex="-1"></a>  tol <span class="ot">&lt;-</span> <span class="fl">1e-4</span></span>
<span id="cb30-72"><a href="#cb30-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-73"><a href="#cb30-73" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 6) Optimization of the model</span></span>
<span id="cb30-74"><a href="#cb30-74" aria-hidden="true" tabindex="-1"></a>  ModelPara <span class="ot">&lt;-</span> <span class="fu">Optimization</span>(f, tol, varargin, FactorLabels, Economies, ModelType)<span class="sc">$</span>Summary</span></code></pre></div>
<p>The tables below compare the ATSM parameter estimates generated from BR (2017) and the <em>MultiATSM</em>. Overall, one can note that the differences in the estimates are economically modest.</p>
<table class=" lightable-classic lightable-striped" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-31">Table 4.1: </span><span class="math inline">\(Q\)</span>-dynamics parameters
</caption>
<thead>
<tr>
<th style="text-align:left;font-size: 14px;">
</th>
<th style="text-align:center;font-size: 14px;">
MultiATSM
</th>
<th style="text-align:center;font-size: 14px;">
BR (2017)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
<span class="math inline">\(r0\)</span>
</td>
<td style="text-align:center;">
0.00055
</td>
<td style="text-align:center;">
-0.00016
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\lambda_1\)</span>
</td>
<td style="text-align:center;">
0.99670
</td>
<td style="text-align:center;">
0.99682
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\lambda_2\)</span>
</td>
<td style="text-align:center;">
0.91488
</td>
<td style="text-align:center;">
0.95945
</td>
</tr>
<tr>
<td style="text-align:left;">
<span class="math inline">\(\lambda_3\)</span>
</td>
<td style="text-align:center;">
0.91488
</td>
<td style="text-align:center;">
0.87174
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<sup></sup> <span class="math inline">\(\lambda\)</span>’s are the eigenvalues from the risk-neutral feedback matrix and <span class="math inline">\(r0\)</span> is the long-run mean of the short rate under Q.
</td>
</tr>
</tfoot>
</table>
<table class=" lightable-classic lightable-striped" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-32">Table 4.2: </span><span class="math inline">\(P\)</span>-dynamics parameters
</caption>
<thead>
<tr>
<th style="empty-cells: hide;" colspan="1">
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; font-weight: bold; " colspan="1">
<div style="TRUE">
K0Z
</div>
</th>
<th style="padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; font-weight: bold; " colspan="5">
<div style="TRUE">
K1Z
</div>
</th>
</tr>
<tr>
<th style="text-align:left;font-size: 14px;">
</th>
<th style="text-align:center;font-size: 14px;">
</th>
<th style="text-align:center;font-size: 14px;">
PC1
</th>
<th style="text-align:center;font-size: 14px;">
PC2
</th>
<th style="text-align:center;font-size: 14px;">
PC3
</th>
<th style="text-align:center;font-size: 14px;">
GRO
</th>
<th style="text-align:center;font-size: 14px;">
INF
</th>
</tr>
</thead>
<tbody>
<tr grouplength="5">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>BR (2017)</strong>
</td>
</tr>
<tr>
<td style="text-align:left; padding-left:  2em;" indentlevel="1">
PC1
</td>
<td style="text-align:center;">
0.07811
</td>
<td style="text-align:center;">
0.93691
</td>
<td style="text-align:center;">
-0.01307
</td>
<td style="text-align:center;">
-0.02181
</td>
<td style="text-align:center;">
0.10457
</td>
<td style="text-align:center;">
0.10033
</td>
</tr>
<tr>
<td style="text-align:left; padding-left:  2em;" indentlevel="1">
PC2
</td>
<td style="text-align:center;">
0.02100
</td>
<td style="text-align:center;">
0.00582
</td>
<td style="text-align:center;">
0.97814
</td>
<td style="text-align:center;">
0.17031
</td>
<td style="text-align:center;">
-0.16719
</td>
<td style="text-align:center;">
-0.04016
</td>
</tr>
<tr>
<td style="text-align:left; padding-left:  2em;" indentlevel="1">
PC3
</td>
<td style="text-align:center;">
0.10047
</td>
<td style="text-align:center;">
-0.01037
</td>
<td style="text-align:center;">
-0.00625
</td>
<td style="text-align:center;">
0.78346
</td>
<td style="text-align:center;">
-0.03987
</td>
<td style="text-align:center;">
0.04369
</td>
</tr>
<tr>
<td style="text-align:left; padding-left:  2em;" indentlevel="1">
GRO
</td>
<td style="text-align:center;">
0.06904
</td>
<td style="text-align:center;">
-0.00483
</td>
<td style="text-align:center;">
0.01801
</td>
<td style="text-align:center;">
-0.11117
</td>
<td style="text-align:center;">
0.88177
</td>
<td style="text-align:center;">
-0.00247
</td>
</tr>
<tr>
<td style="text-align:left; padding-left:  2em;" indentlevel="1">
INF
</td>
<td style="text-align:center;">
0.04996
</td>
<td style="text-align:center;">
0.00185
</td>
<td style="text-align:center;">
0.00642
</td>
<td style="text-align:center;">
-0.05920
</td>
<td style="text-align:center;">
0.02767
</td>
<td style="text-align:center;">
0.98593
</td>
</tr>
<tr grouplength="5">
<td colspan="7" style="border-bottom: 1px solid;">
<strong>MultiATSM</strong>
</td>
</tr>
<tr>
<td style="text-align:left; padding-left:  2em;" indentlevel="1">
PC1
</td>
<td style="text-align:center;">
0.07811
</td>
<td style="text-align:center;">
0.93691
</td>
<td style="text-align:center;">
-0.01307
</td>
<td style="text-align:center;">
-0.02181
</td>
<td style="text-align:center;">
0.10457
</td>
<td style="text-align:center;">
0.10033
</td>
</tr>
<tr>
<td style="text-align:left; padding-left:  2em;" indentlevel="1">
PC2
</td>
<td style="text-align:center;">
0.02100
</td>
<td style="text-align:center;">
0.00582
</td>
<td style="text-align:center;">
0.97814
</td>
<td style="text-align:center;">
0.17031
</td>
<td style="text-align:center;">
-0.16719
</td>
<td style="text-align:center;">
-0.04016
</td>
</tr>
<tr>
<td style="text-align:left; padding-left:  2em;" indentlevel="1">
PC3
</td>
<td style="text-align:center;">
0.10047
</td>
<td style="text-align:center;">
-0.01037
</td>
<td style="text-align:center;">
-0.00625
</td>
<td style="text-align:center;">
0.78346
</td>
<td style="text-align:center;">
-0.03987
</td>
<td style="text-align:center;">
0.04369
</td>
</tr>
<tr>
<td style="text-align:left; padding-left:  2em;" indentlevel="1">
GRO
</td>
<td style="text-align:center;">
0.06904
</td>
<td style="text-align:center;">
-0.00483
</td>
<td style="text-align:center;">
0.01801
</td>
<td style="text-align:center;">
-0.11117
</td>
<td style="text-align:center;">
0.88177
</td>
<td style="text-align:center;">
-0.00247
</td>
</tr>
<tr>
<td style="text-align:left; padding-left:  2em;" indentlevel="1">
INF
</td>
<td style="text-align:center;">
0.04996
</td>
<td style="text-align:center;">
0.00185
</td>
<td style="text-align:center;">
0.00642
</td>
<td style="text-align:center;">
-0.05920
</td>
<td style="text-align:center;">
0.02767
</td>
<td style="text-align:center;">
0.98593
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<sup></sup> <span class="math inline">\(K0Z\)</span> is the intercept and <span class="math inline">\(K1Z\)</span> is feedback matrix from the <span class="math inline">\(P\)</span>-dynamics.
</td>
</tr>
</tfoot>
</table>
<table class=" lightable-classic lightable-striped" style="font-family: &quot;Arial Narrow&quot;, &quot;Source Sans Pro&quot;, sans-serif; width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-33">Table 4.3: </span>Portfolio of yields with errors
</caption>
<thead>
<tr>
<th style="text-align:left;font-size: 14px;">
</th>
<th style="text-align:center;font-size: 14px;">
MultiATSM
</th>
<th style="text-align:center;font-size: 14px;">
BR (2017)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
se
</td>
<td style="text-align:center;">
0.0000546
</td>
<td style="text-align:center;">
0.000055
</td>
</tr>
</tbody>
<tfoot>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<span style="font-style: italic;">Note: </span>
</td>
</tr>
<tr>
<td style="padding: 0; border: 0;" colspan="100%">
<sup></sup> <span class="math inline">\(se\)</span> is the standard deviation of the portfolio of yields observed with errors.
</td>
</tr>
</tfoot>
</table>
<p>It is relevant to highlight that the script above makes use of the principal component weights provided by BR (2017). Such a matrix is simply a scaled-up version of the one provided by the function <em>pca_weights_one_country</em> of this package. Accordingly, despite the numerical differences on the weight matrices, both methods generate time series of spanned factors which are perfectly correlated. Another difference between the two approaches relates to the construction form of the log-likelihood function (llk): while in the BR (2017) code the llk is expressed in terms of a portfolio of yields, the <em>MultiATSM</em> package generates this same input directly as a function of observed yields (i.e. both procedures lead to equivalent llk up to the Jacobian term).</p>
</div>
<div id="candelon-and-moura-2021" class="section level3" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> Candelon and Moura (2021)</h3>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="do">#########################################################################################################</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="do">#################################### USER INPUTS ########################################################</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="do">#########################################################################################################</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="co"># A) Load database data</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;CM_Factors&quot;</span>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&#39;CM_Factors_GVAR&#39;</span>)</span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&#39;CM_Trade&#39;</span>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&#39;CM_Yields&#39;</span>)</span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="co"># B) Decide on general model inputs</span></span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>ModelType <span class="ot">&lt;-</span> <span class="st">&quot;GVAR jointQ&quot;</span> <span class="co"># available options are &quot;JPS&quot;, &quot;JPS jointP&quot;, &quot;GVAR sepQ&quot;, &quot;VAR jointQ&quot;, </span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>                          <span class="co">#&quot;GVAR jointQ&quot;, &quot;JLL original&quot;, &quot;JLL NoDomUnit&quot;, &quot;JLL jointSigma&quot;.</span></span>
<span id="cb31-13"><a href="#cb31-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-14"><a href="#cb31-14" aria-hidden="true" tabindex="-1"></a>StationarityUnderQ <span class="ot">&lt;-</span> <span class="dv">0</span>  </span>
<span id="cb31-15"><a href="#cb31-15" aria-hidden="true" tabindex="-1"></a>BiasCorrection <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb31-16"><a href="#cb31-16" aria-hidden="true" tabindex="-1"></a>WishForwardPremia <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb31-17"><a href="#cb31-17" aria-hidden="true" tabindex="-1"></a>FPmatLim <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">47</span>,<span class="dv">48</span>) </span>
<span id="cb31-18"><a href="#cb31-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-19"><a href="#cb31-19" aria-hidden="true" tabindex="-1"></a>Economies <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;China&quot;</span>,<span class="st">&quot;Brazil&quot;</span>,<span class="st">&quot;Mexico&quot;</span>, <span class="st">&quot;Uruguay&quot;</span>) </span>
<span id="cb31-20"><a href="#cb31-20" aria-hidden="true" tabindex="-1"></a>GlobalVar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;GBC&quot;</span>, <span class="st">&quot;CPI_OECD&quot;</span>) </span>
<span id="cb31-21"><a href="#cb31-21" aria-hidden="true" tabindex="-1"></a>DomVar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;OECD_Det&quot;</span>, <span class="st">&quot;Inflation&quot;</span>) </span>
<span id="cb31-22"><a href="#cb31-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-23"><a href="#cb31-23" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co"># Number of spanned factors per country</span></span>
<span id="cb31-24"><a href="#cb31-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-25"><a href="#cb31-25" aria-hidden="true" tabindex="-1"></a>OutputLabel <span class="ot">&lt;-</span> <span class="st">&quot;CM_2021&quot;</span></span>
<span id="cb31-26"><a href="#cb31-26" aria-hidden="true" tabindex="-1"></a>DataFrequency <span class="ot">&lt;-</span> <span class="st">&quot;Monthly&quot;</span></span>
<span id="cb31-27"><a href="#cb31-27" aria-hidden="true" tabindex="-1"></a>UnitMatYields <span class="ot">&lt;-</span> <span class="st">&quot;Month&quot;</span></span>
<span id="cb31-28"><a href="#cb31-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-29"><a href="#cb31-29" aria-hidden="true" tabindex="-1"></a><span class="co"># B.1) Decide on specific model inputs</span></span>
<span id="cb31-30"><a href="#cb31-30" aria-hidden="true" tabindex="-1"></a><span class="do">#################################### GVAR-based models ##################################################</span></span>
<span id="cb31-31"><a href="#cb31-31" aria-hidden="true" tabindex="-1"></a>t_First_Wgvar <span class="ot">&lt;-</span> <span class="st">&quot;2004&quot;</span></span>
<span id="cb31-32"><a href="#cb31-32" aria-hidden="true" tabindex="-1"></a>t_Last_Wgvar <span class="ot">&lt;-</span>  <span class="st">&quot;2019&quot;</span></span>
<span id="cb31-33"><a href="#cb31-33" aria-hidden="true" tabindex="-1"></a>W_type <span class="ot">&lt;-</span> <span class="st">&#39;Sample Mean&#39;</span></span>
<span id="cb31-34"><a href="#cb31-34" aria-hidden="true" tabindex="-1"></a>VARXtype <span class="ot">&lt;-</span> <span class="st">&quot;unconstrained&quot;</span></span>
<span id="cb31-35"><a href="#cb31-35" aria-hidden="true" tabindex="-1"></a><span class="do">#################################### JLL-based models ###################################################</span></span>
<span id="cb31-36"><a href="#cb31-36" aria-hidden="true" tabindex="-1"></a>DomUnit <span class="ot">&lt;-</span> <span class="st">&quot;China&quot;</span></span>
<span id="cb31-37"><a href="#cb31-37" aria-hidden="true" tabindex="-1"></a>WishSigmas <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb31-38"><a href="#cb31-38" aria-hidden="true" tabindex="-1"></a>SigmaNonOrtho <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb31-39"><a href="#cb31-39" aria-hidden="true" tabindex="-1"></a>JLLModelType <span class="ot">&lt;-</span> ModelType</span>
<span id="cb31-40"><a href="#cb31-40" aria-hidden="true" tabindex="-1"></a><span class="do">###################################### BRW inputs  ######################################################</span></span>
<span id="cb31-41"><a href="#cb31-41" aria-hidden="true" tabindex="-1"></a>flag_mean <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb31-42"><a href="#cb31-42" aria-hidden="true" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb31-43"><a href="#cb31-43" aria-hidden="true" tabindex="-1"></a>N_iter <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb31-44"><a href="#cb31-44" aria-hidden="true" tabindex="-1"></a>N_burn <span class="ot">&lt;-</span> N_iter<span class="sc">*</span><span class="fl">0.15</span></span>
<span id="cb31-45"><a href="#cb31-45" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb31-46"><a href="#cb31-46" aria-hidden="true" tabindex="-1"></a>checkBRW <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb31-47"><a href="#cb31-47" aria-hidden="true" tabindex="-1"></a>B_check <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb31-48"><a href="#cb31-48" aria-hidden="true" tabindex="-1"></a><span class="do">#########################################################################################################</span></span>
<span id="cb31-49"><a href="#cb31-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-50"><a href="#cb31-50" aria-hidden="true" tabindex="-1"></a><span class="co"># C) Decide on Settings for numerical outputs</span></span>
<span id="cb31-51"><a href="#cb31-51" aria-hidden="true" tabindex="-1"></a>Horiz <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb31-52"><a href="#cb31-52" aria-hidden="true" tabindex="-1"></a>DesiredGraphs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Fit&quot;</span>, <span class="st">&quot;GIRF&quot;</span>, <span class="st">&quot;GFEVD&quot;</span>)</span>
<span id="cb31-53"><a href="#cb31-53" aria-hidden="true" tabindex="-1"></a>WishGraphRiskFac <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb31-54"><a href="#cb31-54" aria-hidden="true" tabindex="-1"></a>WishGraphYields <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb31-55"><a href="#cb31-55" aria-hidden="true" tabindex="-1"></a>WishOrthoJLLgraphs <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb31-56"><a href="#cb31-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-57"><a href="#cb31-57" aria-hidden="true" tabindex="-1"></a><span class="co"># D) Bootstrap settings</span></span>
<span id="cb31-58"><a href="#cb31-58" aria-hidden="true" tabindex="-1"></a>WishBootstrap <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb31-59"><a href="#cb31-59" aria-hidden="true" tabindex="-1"></a>Bootlist <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb31-60"><a href="#cb31-60" aria-hidden="true" tabindex="-1"></a>Bootlist<span class="sc">$</span>methodBS <span class="ot">&lt;-</span> <span class="st">&#39;bs&#39;</span> </span>
<span id="cb31-61"><a href="#cb31-61" aria-hidden="true" tabindex="-1"></a>Bootlist<span class="sc">$</span>BlockLength <span class="ot">&lt;-</span> <span class="dv">4</span> </span>
<span id="cb31-62"><a href="#cb31-62" aria-hidden="true" tabindex="-1"></a>Bootlist<span class="sc">$</span>ndraws <span class="ot">&lt;-</span>  <span class="dv">1000</span></span>
<span id="cb31-63"><a href="#cb31-63" aria-hidden="true" tabindex="-1"></a>Bootlist<span class="sc">$</span>pctg   <span class="ot">&lt;-</span>  <span class="dv">95</span> </span>
<span id="cb31-64"><a href="#cb31-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-65"><a href="#cb31-65" aria-hidden="true" tabindex="-1"></a><span class="co"># E) Out-of-sample forecast</span></span>
<span id="cb31-66"><a href="#cb31-66" aria-hidden="true" tabindex="-1"></a>WishForecast <span class="ot">&lt;-</span> <span class="dv">0</span> </span>
<span id="cb31-67"><a href="#cb31-67" aria-hidden="true" tabindex="-1"></a>ForecastList <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb31-68"><a href="#cb31-68" aria-hidden="true" tabindex="-1"></a>ForecastList<span class="sc">$</span>ForHoriz <span class="ot">&lt;-</span> <span class="dv">12</span> </span>
<span id="cb31-69"><a href="#cb31-69" aria-hidden="true" tabindex="-1"></a>ForecastList<span class="sc">$</span>t0Sample <span class="ot">&lt;-</span> <span class="dv">1</span> </span>
<span id="cb31-70"><a href="#cb31-70" aria-hidden="true" tabindex="-1"></a>ForecastList<span class="sc">$</span>t0Forecast <span class="ot">&lt;-</span> <span class="dv">90</span> </span>
<span id="cb31-71"><a href="#cb31-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-72"><a href="#cb31-72" aria-hidden="true" tabindex="-1"></a><span class="do">#########################################################################################################</span></span>
<span id="cb31-73"><a href="#cb31-73" aria-hidden="true" tabindex="-1"></a><span class="do">############################### NO NEED TO MAKE CHANGES FROM HERE #######################################</span></span>
<span id="cb31-74"><a href="#cb31-74" aria-hidden="true" tabindex="-1"></a><span class="do">#########################################################################################################</span></span>
<span id="cb31-75"><a href="#cb31-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-76"><a href="#cb31-76" aria-hidden="true" tabindex="-1"></a><span class="co"># 2) Minor preliminary work</span></span>
<span id="cb31-77"><a href="#cb31-77" aria-hidden="true" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="fu">length</span>(Economies)</span>
<span id="cb31-78"><a href="#cb31-78" aria-hidden="true" tabindex="-1"></a>FactorLabels <span class="ot">&lt;-</span> <span class="fu">LabFac</span>(N, DomVar,GlobalVar, Economies, ModelType)</span>
<span id="cb31-79"><a href="#cb31-79" aria-hidden="true" tabindex="-1"></a>ZZ <span class="ot">&lt;-</span> RiskFactors</span>
<span id="cb31-80"><a href="#cb31-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-81"><a href="#cb31-81" aria-hidden="true" tabindex="-1"></a>Data <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb31-82"><a href="#cb31-82" aria-hidden="true" tabindex="-1"></a>Data<span class="sc">$</span>GVARFactors <span class="ot">&lt;-</span> FactorsGVAR</span>
<span id="cb31-83"><a href="#cb31-83" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">&lt;-</span> <span class="fu">Maturities</span>(Yields, Economies, <span class="at">UnitYields =</span> UnitMatYields)</span>
<span id="cb31-84"><a href="#cb31-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-85"><a href="#cb31-85" aria-hidden="true" tabindex="-1"></a><span class="co"># 2.1) Generate GVARinputs, JLLinputs and BRWinputs</span></span>
<span id="cb31-86"><a href="#cb31-86" aria-hidden="true" tabindex="-1"></a>ModInputs <span class="ot">&lt;-</span> <span class="fu">ListModelInputs</span>(ModelType, Data, Economies, VARXtype, t_First_Wgvar, t_Last_Wgvar, W_type,</span>
<span id="cb31-87"><a href="#cb31-87" aria-hidden="true" tabindex="-1"></a>                             DomUnit, WishSigmas, SigmaNonOrtho, BiasCorrection, flag_mean, gamma, N_iter,</span>
<span id="cb31-88"><a href="#cb31-88" aria-hidden="true" tabindex="-1"></a>                             N_burn, B, checkBRW, B_check)</span>
<span id="cb31-89"><a href="#cb31-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-90"><a href="#cb31-90" aria-hidden="true" tabindex="-1"></a>GVARinputs <span class="ot">&lt;-</span> ModInputs<span class="sc">$</span>GVARinputs</span>
<span id="cb31-91"><a href="#cb31-91" aria-hidden="true" tabindex="-1"></a>JLLinputs <span class="ot">&lt;-</span> ModInputs<span class="sc">$</span>JLLinputs</span>
<span id="cb31-92"><a href="#cb31-92" aria-hidden="true" tabindex="-1"></a>BRWinputs <span class="ot">&lt;-</span> ModInputs<span class="sc">$</span>BRWinputs</span>
<span id="cb31-93"><a href="#cb31-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-94"><a href="#cb31-94" aria-hidden="true" tabindex="-1"></a><span class="co"># 3) Prepare the inputs of the likelihood function</span></span>
<span id="cb31-95"><a href="#cb31-95" aria-hidden="true" tabindex="-1"></a>ModelParaList <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb31-96"><a href="#cb31-96" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>C){</span>
<span id="cb31-97"><a href="#cb31-97" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (( ModelType <span class="sc">==</span> <span class="st">&quot;GVAR jointQ&quot;</span> <span class="sc">||</span> ModelType <span class="sc">==</span> <span class="st">&quot;VAR jointQ&quot;</span> <span class="sc">||</span> ModelType <span class="sc">==</span> <span class="st">&quot;JLL original&quot;</span></span>
<span id="cb31-98"><a href="#cb31-98" aria-hidden="true" tabindex="-1"></a>        <span class="sc">||</span> ModelType <span class="sc">==</span> <span class="st">&quot;JLL NoDomUnit&quot;</span> <span class="sc">||</span> ModelType <span class="sc">==</span> <span class="st">&quot;JLL jointSigma&quot;</span> )   <span class="sc">&amp;</span> i <span class="sc">&gt;</span><span class="dv">1</span> ){<span class="cf">break</span>} </span>
<span id="cb31-99"><a href="#cb31-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-100"><a href="#cb31-100" aria-hidden="true" tabindex="-1"></a><span class="co"># 3.1) Compute the inputs that go directly into the log-likelihood function</span></span>
<span id="cb31-101"><a href="#cb31-101" aria-hidden="true" tabindex="-1"></a>ATSMInputs <span class="ot">&lt;-</span> <span class="fu">InputsForMLEdensity</span>(ModelType, Yields, ZZ, FactorLabels, mat, Economies, DataFrequency, </span>
<span id="cb31-102"><a href="#cb31-102" aria-hidden="true" tabindex="-1"></a>                                  JLLinputs, GVARinputs, BRWinputs)</span>
<span id="cb31-103"><a href="#cb31-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-104"><a href="#cb31-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-105"><a href="#cb31-105" aria-hidden="true" tabindex="-1"></a><span class="co"># 3.2) Initial guesses for Variables that will be concentrared out of from the log-likelihood function</span></span>
<span id="cb31-106"><a href="#cb31-106" aria-hidden="true" tabindex="-1"></a>K1XQ <span class="ot">&lt;-</span> ATSMInputs<span class="sc">$</span>K1XQ</span>
<span id="cb31-107"><a href="#cb31-107" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (ModelType <span class="sc">==</span> <span class="st">&quot;JLL original&quot;</span> <span class="sc">||</span> ModelType <span class="sc">==</span> <span class="st">&quot;JLL NoDomUnit&quot;</span> ){ SSZ <span class="ot">&lt;-</span> <span class="cn">NULL</span>} <span class="cf">else</span>{SSZ <span class="ot">&lt;-</span> ATSMInputs<span class="sc">$</span>SSZ}</span>
<span id="cb31-108"><a href="#cb31-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-109"><a href="#cb31-109" aria-hidden="true" tabindex="-1"></a><span class="co"># 4) Build the objective function</span></span>
<span id="cb31-110"><a href="#cb31-110" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">Functionf</span>(ATSMInputs, Economies, mat, DataFrequency, FactorLabels, ModelType)</span>
<span id="cb31-111"><a href="#cb31-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-112"><a href="#cb31-112" aria-hidden="true" tabindex="-1"></a><span class="co"># 5) Set the optimization settings</span></span>
<span id="cb31-113"><a href="#cb31-113" aria-hidden="true" tabindex="-1"></a>VarLab <span class="ot">&lt;-</span> <span class="fu">ParaLabels</span>(ModelType, StationarityUnderQ)</span>
<span id="cb31-114"><a href="#cb31-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-115"><a href="#cb31-115" aria-hidden="true" tabindex="-1"></a>varargin <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb31-116"><a href="#cb31-116" aria-hidden="true" tabindex="-1"></a>varargin<span class="sc">$</span>K1XQ <span class="ot">&lt;-</span><span class="fu">list</span>(K1XQ, VarLab[[ModelType]][[<span class="st">&quot;K1XQ&quot;</span>]] , <span class="cn">NULL</span> , <span class="cn">NULL</span>)</span>
<span id="cb31-117"><a href="#cb31-117" aria-hidden="true" tabindex="-1"></a>varargin<span class="sc">$</span>SSZ <span class="ot">&lt;-</span> <span class="fu">list</span>(SSZ, VarLab[[ModelType]][[<span class="st">&quot;SSZ&quot;</span>]], <span class="cn">NULL</span>, <span class="cn">NULL</span>)</span>
<span id="cb31-118"><a href="#cb31-118" aria-hidden="true" tabindex="-1"></a>varargin<span class="sc">$</span>r0 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cn">NULL</span>, VarLab[[ModelType]][[<span class="st">&quot;r0&quot;</span>]], <span class="cn">NULL</span>, <span class="cn">NULL</span>)</span>
<span id="cb31-119"><a href="#cb31-119" aria-hidden="true" tabindex="-1"></a>varargin<span class="sc">$</span>se <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cn">NULL</span>, VarLab[[ModelType]][[<span class="st">&quot;se&quot;</span>]], <span class="fl">1e-6</span>, <span class="cn">NULL</span>)</span>
<span id="cb31-120"><a href="#cb31-120" aria-hidden="true" tabindex="-1"></a>varargin<span class="sc">$</span>K0Z <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cn">NULL</span>, VarLab[[ModelType]][[<span class="st">&quot;K0Z&quot;</span>]], <span class="cn">NULL</span>, <span class="cn">NULL</span>)</span>
<span id="cb31-121"><a href="#cb31-121" aria-hidden="true" tabindex="-1"></a>varargin<span class="sc">$</span>K1Z <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="cn">NULL</span>, VarLab[[ModelType]][[<span class="st">&quot;K1Z&quot;</span>]], <span class="cn">NULL</span>, <span class="cn">NULL</span>)</span>
<span id="cb31-122"><a href="#cb31-122" aria-hidden="true" tabindex="-1"></a>varargin<span class="sc">$</span>OptRun <span class="ot">&lt;-</span>  <span class="fu">c</span>(<span class="st">&quot;iter off&quot;</span>)</span>
<span id="cb31-123"><a href="#cb31-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-124"><a href="#cb31-124" aria-hidden="true" tabindex="-1"></a>LabelVar<span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Value&#39;</span>, <span class="st">&#39;Label&#39;</span>, <span class="st">&#39;LB&#39;</span>, <span class="st">&#39;UB&#39;</span>) </span>
<span id="cb31-125"><a href="#cb31-125" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (d <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(varargin)<span class="sc">-</span><span class="dv">1</span>)){ <span class="fu">names</span>(varargin[[d]]) <span class="ot">&lt;-</span>  LabelVar}</span>
<span id="cb31-126"><a href="#cb31-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-127"><a href="#cb31-127" aria-hidden="true" tabindex="-1"></a>tol <span class="ot">&lt;-</span> <span class="fl">1e-4</span></span>
<span id="cb31-128"><a href="#cb31-128" aria-hidden="true" tabindex="-1"></a><span class="co"># 6) Optimization of the model</span></span>
<span id="cb31-129"><a href="#cb31-129" aria-hidden="true" tabindex="-1"></a>ModelParaList[[ModelType]] <span class="ot">&lt;-</span> <span class="fu">Optimization</span>(f, tol, varargin, FactorLabels, Economies, ModelType,</span>
<span id="cb31-130"><a href="#cb31-130" aria-hidden="true" tabindex="-1"></a>                                           JLLinputs, GVARinputs)<span class="sc">$</span>Summary</span>
<span id="cb31-131"><a href="#cb31-131" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb31-132"><a href="#cb31-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-133"><a href="#cb31-133" aria-hidden="true" tabindex="-1"></a><span class="co"># 7) Numerical Outputs</span></span>
<span id="cb31-134"><a href="#cb31-134" aria-hidden="true" tabindex="-1"></a>InputsForOutputs <span class="ot">&lt;-</span> <span class="fu">InputsForOutputs</span>(ModelType, Horiz, DesiredGraphs, OutputLabel, StationarityUnderQ,</span>
<span id="cb31-135"><a href="#cb31-135" aria-hidden="true" tabindex="-1"></a>                                     UnitMatYields, WishGraphYields, WishGraphRiskFac, WishOrthoJLLgraphs, </span>
<span id="cb31-136"><a href="#cb31-136" aria-hidden="true" tabindex="-1"></a>                                     WishForwardPremia, FPmatLim, WishBootstrap, Bootlist, WishForecast,</span>
<span id="cb31-137"><a href="#cb31-137" aria-hidden="true" tabindex="-1"></a>                                     ForecastList)</span>
<span id="cb31-138"><a href="#cb31-138" aria-hidden="true" tabindex="-1"></a><span class="co"># A) Fit, IRF, FEVD, GIRF, GFEVD and Risk premia</span></span>
<span id="cb31-139"><a href="#cb31-139" aria-hidden="true" tabindex="-1"></a>NumericalOutputs <span class="ot">&lt;-</span> <span class="fu">NumOutputs</span>(ModelType, ModelParaList, InputsForOutputs, FactorLabels, Economies)</span>
<span id="cb31-140"><a href="#cb31-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-141"><a href="#cb31-141" aria-hidden="true" tabindex="-1"></a><span class="co"># B) Bootstrap</span></span>
<span id="cb31-142"><a href="#cb31-142" aria-hidden="true" tabindex="-1"></a>Bootstrap <span class="ot">&lt;-</span> <span class="fu">Bootstrap</span>(ModelType, ModelParaList, NumericalOutputs, mat, Economies, InputsForOutputs,</span>
<span id="cb31-143"><a href="#cb31-143" aria-hidden="true" tabindex="-1"></a>                       FactorLabels, DataFrequency, varargin, JLLinputs, GVARinputs, BRWinputs)</span>
<span id="cb31-144"><a href="#cb31-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-145"><a href="#cb31-145" aria-hidden="true" tabindex="-1"></a><span class="co"># C) Out-of-sample forecasting</span></span>
<span id="cb31-146"><a href="#cb31-146" aria-hidden="true" tabindex="-1"></a>Forecasts <span class="ot">&lt;-</span> <span class="fu">ForecastYields</span>(ModelType, ModelParaList, InputsForOutputs, FactorLabels, Economies,</span>
<span id="cb31-147"><a href="#cb31-147" aria-hidden="true" tabindex="-1"></a>                            DataFrequency, JLLinputs, GVARinputs, BRWinputs)</span></code></pre></div>
</div>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-AngPiazzesi2003JME" class="csl-entry">
Ang, Andrew, and Monika Piazzesi. 2003. <span>“A No-Arbitrage Vector Autoregression of Term Structure Dynamics with Macroeconomic and Latent Variables.”</span> <em>Journal of Monetary Economics</em> 50 (4): 745–87.
</div>
<div id="ref-BauerRudebusch2017" class="csl-entry">
Bauer, Michael D, and Glenn D Rudebusch. 2017. <span>“Resolving the Spanning Puzzle in Macro-Finance Term Structure Models.”</span> <em>Review of Finance</em> 21 (2): 511–53.
</div>
<div id="ref-BauerRudebuschWu2012" class="csl-entry">
Bauer, Michael D, Glenn D Rudebusch, and Jing Cynthia Wu. 2012. <span>“Correcting Estimation Bias in Dynamic Term Structure Models.”</span> <em>Journal of Business &amp; Economic Statistics</em> 30 (3): 454–67.
</div>
<div id="ref-CandelonMoura2021" class="csl-entry">
Candelon, Bertrand, and Rubens Moura. 2021. <span>“A Multi-Country Model of the Term Structures of Interest Rates with a GVAR.”</span> LFIN Working Paper Series.
</div>
<div id="ref-JoslinPriebschSingleton2014" class="csl-entry">
Joslin, Scott, Marcel Priebsch, and Kenneth J. Singleton. 2014. <span>“Risk Premiums in Dynamic Term Structure Models with Unspanned Macro Risks.”</span> <em>Journal of Finance</em> 69 (3): 1197–1233.
</div>
<div id="ref-JotikasthiraLeLundblad2015" class="csl-entry">
Jotikasthira, Chotibhak, Anh Le, and Christian Lundblad. 2015. <span>“Why Do Term Structures in Different Currencies Co-Move?”</span> <em>Journal of Financial Economics</em> 115: 58–83.
</div>
<div id="ref-LeSingleton2018" class="csl-entry">
Le, Anh, and Ken Singleton. 2018. <span>“A Small Package of Matlab Routines for the Estimation of Some Term Structure Models.”</span> Euro Area Business Cycle Network Training School - Term Structure Modelling.
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
